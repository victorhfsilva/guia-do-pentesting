# Comandos do Sistema Operacional

Executar programas do sistema operacional a partir de um script Python pode ser muito útil quando você deseja automatizar tarefas, interagir com outros aplicativos ou acessar recursos do sistema. O Python fornece várias maneiras de fazer isso, principalmente por meio dos módulos `subprocess` e `os`. 
## **Usando o Módulo `subprocess`**

O módulo `subprocess` é a maneira recomendada de executar comandos externos em Python, pois oferece mais controle e flexibilidade do que o módulo `os`. Ele permite executar programas do sistema, capturar saídas, lidar com erros e até mesmo enviar dados para os processos.

### Executando um Comando Simples

A função `subprocess.run()` executa um comando e espera que ele termine. O comando é passado como uma lista, onde o primeiro item é o programa e os demais são os argumentos.

**Exemplo básico:**
```python
import subprocess

# Executa o comando 'ls' no Linux ou 'dir' no Windows
subprocess.run(["ls"])  # ou subprocess.run(["dir"], shell=True) no Windows
```

No exemplo acima, o comando `ls` (no Linux/macOS) ou `dir` (no Windows) será executado, e a lista de arquivos e diretórios será exibida no terminal.

#### Capturando a Saída do Comando

Para capturar a saída do comando em vez de apenas exibi-la, você pode usar o argumento `capture_output=True`. Isso armazena a saída no objeto retornado pela função `subprocess.run()`.

**Exemplo:**
```python
import subprocess

# Executa o comando e captura a saída
resultado = subprocess.run(["ls"], capture_output=True, text=True)

# Imprime a saída capturada
print("Saída do comando:", resultado.stdout)
```

Aqui, o conteúdo da saída padrão do comando `ls` será armazenado em `resultado.stdout`.

#### Tratando Erros

Se o comando executado falhar, você pode capturar o código de retorno ou os erros usando `stderr`.

**Exemplo:**
```python
import subprocess

# Tenta executar um comando que não existe
resultado = subprocess.run(["comando_inexistente"], capture_output=True, text=True)

# Verifica o código de retorno (0 indica sucesso, qualquer outro valor indica erro)
if resultado.returncode != 0:
    print("Erro ao executar o comando:", resultado.stderr)
```

Se o comando falhar, o código de retorno será diferente de 0, e a mensagem de erro será armazenada em `resultado.stderr`.

#### Passando Argumentos para o Comando
Os argumentos são passados como elementos da lista. Não é necessário concatenar tudo em uma string.

**Exemplo:**
```python
import subprocess

# Executa o comando 'ping' com o argumento 'www.google.com'
subprocess.run(["ping", "-c", "4", "www.google.com"])
```

Neste exemplo, o Python executa o comando `ping` com o argumento `-c 4` (para enviar 4 pacotes) ao host `www.google.com`.

###  **Executando Comandos com o Módulo `os`**

O módulo `os` também pode ser usado para executar comandos do sistema, mas é mais limitado e menos seguro que o `subprocess`.

#### Usando `os.system()`
A função `os.system()` executa um comando diretamente no shell do sistema, mas não oferece controle sobre a saída do comando ou sobre possíveis erros.

**Exemplo:**
```python
import os

# Executa o comando 'ls'
os.system("ls")  # No Windows, use 'dir'
```

Essa função simplesmente executa o comando, e a saída é exibida diretamente no console. No entanto, ela não retorna a saída ou o resultado do comando.

#### Usando `os.popen()`
Para capturar a saída do comando, você pode usar `os.popen()`. Essa função abre um pipe para o comando e permite ler sua saída.

**Exemplo:**
```python
import os

# Executa o comando e captura a saída
saida = os.popen("ls").read()

# Imprime a saída capturada
print(saida)
```

Nesse exemplo, a saída do comando `ls` será armazenada na variável `saida`.

###  **Executando Comandos com `subprocess.Popen`**

Além de `subprocess.run()`, o módulo `subprocess` também oferece `Popen`, uma função mais avançada e flexível para a execução de comandos. `Popen` é útil quando você precisa de controle total sobre os fluxos de entrada, saída e erro do processo.

#### Exemplo Usando `Popen`
```python
import subprocess

# Inicia o processo
processo = subprocess.Popen(["ping", "-c", "4", "www.google.com"], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)

# Captura a saída e os erros
saida, erro = processo.communicate()

# Exibe a saída
print("Saída do comando:", saida)

# Exibe erros, se houver
if erro:
    print("Erro:", erro)
```

O `Popen` inicia o processo e permite que você interaja com ele enquanto ele está em execução, além de capturar a saída e os erros.

### **Executando Scripts Python a Partir de Outro Script**

Você também pode executar outros scripts Python a partir de um script Python.

#### Usando `subprocess`
Você pode chamar um script Python da mesma forma que executaria um comando do sistema.

**Exemplo:**
```python
import subprocess

# Executa outro script Python
subprocess.run(["python", "outro_script.py"])
```

Aqui, o comando executa o script `outro_script.py` usando o Python.

### **Interagindo com o Programa Durante a Execução**

Em alguns casos, pode ser necessário enviar entrada para o programa enquanto ele está em execução. Isso pode ser feito usando `Popen` com o argumento `stdin`.

**Exemplo:**
```python
import subprocess

# Inicia o processo e define que vamos enviar dados para a entrada padrão
processo = subprocess.Popen(["python", "script_entrada.py"], stdin=subprocess.PIPE, stdout=subprocess.PIPE, text=True)

# Envia a entrada para o script
saida, erro = processo.communicate(input="Olá, mundo!")

# Imprime a saída
print(saida)
```

Nesse exemplo, estamos executando um script que espera por entrada e enviamos o texto `"Olá, mundo!"` para ele.

### **Executando Comandos de Forma Segura**

É importante ter cuidado ao executar comandos do sistema operacional diretamente, especialmente quando os argumentos são fornecidos por usuários. A concatenação de strings sem controle pode abrir portas para **injeção de comandos**, um risco de segurança.

#### **Exemplo inseguro (não faça isso):**
```python
import os

# Não use essa abordagem com entrada direta do usuário
comando = "ls " + input("Digite um diretório: ")
os.system(comando)
```

Se o usuário inserir um comando malicioso, como `; rm -rf /`, isso pode resultar na exclusão de arquivos importantes do sistema.

#### **Exemplo seguro:**
Usar `subprocess` com argumentos como lista é uma maneira segura de evitar injeção de comandos.

```python
import subprocess

# Argumentos passados de forma segura
diretorio = input("Digite um diretório: ")
subprocess.run(["ls", diretorio])
```