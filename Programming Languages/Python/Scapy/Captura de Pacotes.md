# Captura de Pacotes

#### Captura e Exibição de Pacotes

Capturar pacotes permite analisar o tráfego de rede em tempo real. A função `sniff()` do Scapy é usada para isso.

- **Capturando Pacotes com Scapy**

  O exemplo abaixo captura pacotes da rede e exibe informações básicas sobre cada pacote capturado:

  ```python
  from scapy.all import *

  # Função de callback para exibir o pacote capturado
  def exibir_pacote(pacote):
      pacote.show()

  # Captura 5 pacotes da interface padrão e exibe cada um deles
  pacotes_capturados = sniff(count=5, prn=exibir_pacote)
  ```

  - `count=5`: Define o número de pacotes a serem capturados.
  - `prn=exibir_pacote`: Especifica a função de callback que é chamada para cada pacote capturado.
  
- **Capturando Pacotes Indefinidamente**

  Para capturar pacotes até que você interrompa manualmente (CTRL+C):

  ```python
  # Captura pacotes indefinidamente
  sniff(prn=exibir_pacote)
  ```

- **Capturando Pacotes em uma Interface Específica**

  Se desejar capturar pacotes de uma interface de rede específica (como `eth0`):

  ```python
  sniff(iface="eth0", count=10, prn=exibir_pacote)
  ```

  - `iface="eth0"`: Define a interface a ser monitorada.

#### Uso de Filtros BPF para Capturar Pacotes Específicos

Filtros BPF (Berkeley Packet Filter) permitem capturar pacotes que atendem a critérios específicos, como endereços IP ou protocolos específicos.

- **Capturando Apenas Pacotes ICMP (Ping)**

  Para capturar apenas pacotes ICMP, use o filtro `icmp`:

  ```python
  # Captura pacotes ICMP (ping)
  sniff(filter="icmp", count=5, prn=exibir_pacote)
  ```

- **Capturando Pacotes para uma Porta Específica**

  Para capturar pacotes TCP destinados à porta 80 (HTTP):

  ```python
  # Captura pacotes TCP destinados à porta 80
  sniff(filter="tcp port 80", count=5, prn=exibir_pacote)
  ```

- **Capturando Pacotes de um IP Específico**

  Para capturar pacotes de um IP específico:

  ```python
  # Captura pacotes originados do IP 192.168.1.1
  sniff(filter="src host 192.168.1.1", count=5, prn=exibir_pacote)
  ```
