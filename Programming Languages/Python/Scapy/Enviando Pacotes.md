### Guia para Enviar Pacotes com Scapy

O envio de pacotes com Scapy é uma operação central para testes de redes, análise de tráfego e simulação de comunicações. Este guia aborda as formas de enviar pacotes, explorando as funções `send()`, `sendp()`, `sr()`, `sr1()`, `srp()`, e `srp1()`, que cobrem desde o envio básico até interações mais complexas com respostas esperadas.

#### Enviando Pacotes com `send()`

A função `send()` é usada para enviar pacotes na camada de rede (camada 3, como IP). É ideal para pacotes IP, TCP, ICMP, entre outros.

- **Exemplo: Enviando um Pacote ICMP (Ping)**

  Envia um pacote ICMP para o Google (8.8.8.8):

  ```python
  from scapy.all import *

  # Criar um pacote ICMP para o IP 8.8.8.8
  pacote = IP(dst="8.8.8.8")/ICMP()

  # Enviar o pacote
  send(pacote)
  ```

  - `IP(dst="8.8.8.8")`: Define o endereço de destino.
  - `/ICMP()`: Adiciona a camada ICMP (usada para "ping").

#### Enviando Pacotes na Camada de Enlace com `sendp()`

A função `sendp()` é usada para enviar pacotes na camada de enlace (camada 2, como Ethernet), útil para ARP, pacotes Ethernet ou pacotes personalizados que operam abaixo da camada IP.

- **Exemplo: Enviando um Pacote ARP**

  Envia um pacote de requisição ARP para descobrir o endereço MAC de um IP específico:

  ```python
  from scapy.all import *

  # Criar um pacote ARP para broadcast
  pacote_arp = Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst="192.168.1.2")

  # Enviar o pacote
  sendp(pacote_arp)
  ```

  - `Ether(dst="ff:ff:ff:ff:ff:ff")`: Cria uma camada Ethernet com endereço de broadcast.
  - `/ARP(pdst="192.168.1.2")`: Adiciona uma camada ARP com IP de destino.

#### Envio e Recepção de Pacotes com `sr()` e `sr1()`

As funções `sr()` e `sr1()` permitem enviar pacotes e esperar respostas, ideal para testes de conexões e interações com serviços de rede.

- **Uso de `sr()`: Enviar Pacotes e Receber Múltiplas Respostas**

  Envia pacotes ICMP para múltiplos destinos e coleta todas as respostas:

  ```python
  from scapy.all import *

  # Criar um pacote ICMP
  pacote = IP(dst="192.168.0.2")/ICMP()

  # Enviar o pacote e receber respostas
  respostas, nao_respondidos = sr(pacote, timeout=2)

  # Exibir respostas
  respostas.summary()
  ```

  - `timeout=2`: Define um tempo limite para esperar por respostas.
  - `respostas.summary()`: Exibe um resumo das respostas recebidas.

- **Uso de `sr1()`: Enviar Pacote e Receber a Primeira Resposta**

  Esta função é usada para enviar um pacote e receber apenas a primeira resposta. Útil quando se espera apenas uma resposta, como ao enviar uma requisição SYN para um servidor.

  ```python
  from scapy.all import *

  # Criar um pacote TCP SYN
  pacote_syn = IP(dst="8.8.8.8")/TCP(dport=80, flags="S")

  # Enviar o pacote e receber a primeira resposta
  resposta = sr1(pacote_syn, timeout=2)

  # Exibir a resposta
  if resposta:
      resposta.show()
  else:
      print("Nenhuma resposta recebida.")
  ```

  - `flags="S"`: Define a flag SYN, usada para iniciar uma conexão TCP.

#### Envio de Pacotes Ethernet com `srp()` e `srp1()`

As funções `srp()` e `srp1()` enviam pacotes na camada de enlace e esperam respostas. São úteis para pacotes personalizados de Ethernet, como ARP.

- **Uso de `srp()`: Enviar Pacotes Ethernet e Receber Respostas**

  Envia uma requisição ARP e coleta todas as respostas na rede local:

  ```python
  from scapy.all import *

  # Criar um pacote ARP para descobrir dispositivos na rede
  pacote_arp = Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst="192.168.1.0/24")

  # Enviar o pacote e receber respostas
  respostas, nao_respondidos = srp(pacote_arp, timeout=2)

  # Exibir dispositivos respondentes
  respostas.summary()
  ```

- **Uso de `srp1()`: Enviar Pacote Ethernet e Receber Primeira Resposta**

  Envia um pacote ARP e recebe apenas a primeira resposta:

  ```python
  from scapy.all import *

  # Criar um pacote ARP
  pacote_arp = Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst="192.168.1.2")

  # Enviar o pacote e receber a primeira resposta
  resposta = srp1(pacote_arp, timeout=2)

  # Exibir a resposta, se recebida
  if resposta:
      resposta.show()
  else:
      print("Nenhuma resposta recebida.")
  ```
