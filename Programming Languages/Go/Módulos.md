# Módulos e Instalação de Pacotes no Go

Go introduziu o sistema de **módulos** a partir da versão 1.11 como forma nativa de gerenciamento de dependências, substituindo o antigo modelo baseado em `GOPATH`. Módulos facilitam o gerenciamento de pacotes, permitem versionamento explícito e oferecem um fluxo de trabalho simplificado para desenvolvimento de projetos Go. 

### **O Que São Módulos em Go?**

Um módulo em Go é uma coleção de pacotes e seus arquivos que são organizados sob um diretório raiz e versionados juntos. Cada projeto Go que utiliza o sistema de módulos tem um arquivo `go.mod` que declara as dependências do projeto, versões usadas e outras informações relevantes.

### **Configurando um Módulo**

Quando você inicia um novo projeto Go, a primeira coisa a fazer é inicializar o módulo. Isso cria um arquivo `go.mod` no diretório raiz do projeto, que gerencia todas as dependências.

#### Exemplo de configuração:

```bash
mkdir meu-projeto
cd meu-projeto
go mod init github.com/usuario/meu-projeto
```

O comando `go mod init` cria o arquivo `go.mod` no diretório do projeto. O argumento passado (`github.com/usuario/meu-projeto`) é o caminho do módulo, que pode ser um repositório remoto se você planeja compartilhar o código.

O arquivo `go.mod` gerado será parecido com isso:

```go
module github.com/usuario/meu-projeto

go 1.20
```

### **Instalando Pacotes com Módulos**

Uma das maiores vantagens do sistema de módulos é a instalação automática de pacotes e dependências. Quando você importa um pacote externo no seu código, o Go resolve a dependência e a instala automaticamente no seu projeto.

#### Exemplo de instalação automática:

No arquivo `main.go`, vamos adicionar uma dependência externa:

```go
package main

import (
    "fmt"
    "github.com/gorilla/mux"
)

func main() {
    r := mux.NewRouter()
    fmt.Println("Roteador criado:", r)
}
```

Ao tentar compilar ou rodar este programa, o Go detecta que o pacote `github.com/gorilla/mux` não está presente e o instala automaticamente.

```bash
go run main.go
```

O Go vai buscar o pacote, instalá-lo e atualizar o arquivo `go.mod` com a versão apropriada. O arquivo `go.mod` será atualizado para:

```go
module github.com/usuario/meu-projeto

go 1.20

require github.com/gorilla/mux v1.8.0
```

O Go também cria um arquivo `go.sum`, que contém hashes das versões das dependências, para garantir que o código seja reprodutível e confiável.

### **Gerenciando Dependências**

As dependências em Go são gerenciadas automaticamente no arquivo `go.mod`, mas você pode interagir diretamente com elas usando os seguintes comandos:

#### **Adicionar uma Dependência Específica**

Você pode adicionar uma dependência explicitamente usando o comando `go get`:

```bash
go get github.com/sirupsen/logrus@v1.7.0
```

Isso adicionará a versão `v1.7.0` do pacote `github.com/sirupsen/logrus` ao seu projeto, e o `go.mod` será atualizado para refletir essa dependência.

#### **Atualizar Dependências**

Para atualizar todas as dependências do projeto para as últimas versões compatíveis, use o comando:

```bash
go get -u ./...
```

Se você quiser atualizar apenas um pacote específico, pode usar:

```bash
go get -u github.com/gorilla/mux
```

####  **Remover Dependências Não Utilizadas**

O Go automaticamente remove dependências não utilizadas do arquivo `go.mod` quando você compila ou executa o projeto. Porém, você pode forçar essa limpeza com o comando:

```bash
go mod tidy
```

Esse comando remove dependências não usadas do `go.mod` e `go.sum`.

### **Trabalhando com Versões de Módulos**

O sistema de módulos em Go suporta versionamento semântico (semver), o que significa que cada módulo segue a convenção de versionamento `MAJOR.MINOR.PATCH` (ex: `v1.2.3`).

#### **Instalando Versões Específicas**

Se você quiser uma versão específica de um pacote, pode especificá-la usando o comando `go get`:

```bash
go get github.com/gorilla/mux@v1.6.2
```

Isso força o Go a baixar essa versão específica e atualizar o `go.mod` de acordo.

#### **Atualizando para a Última Versão**

Se você quiser forçar a atualização para a última versão disponível de um pacote, use:

```bash
go get -u github.com/gorilla/mux
```

#### **Módulos Pré-Lançamento (Beta/RC)**

Para trabalhar com versões de pré-lançamento, você pode usar o sufixo adequado, como `beta` ou `rc` (release candidate), quando for especificar a versão:

```bash
go get github.com/gorilla/mux@v1.8.0-beta.1
```

### **Módulos Locais**

Se você estiver desenvolvendo um módulo localmente e quiser usá-lo em outro projeto sem publicá-lo em um repositório remoto, pode usar um caminho relativo no seu `go.mod`:

#### Exemplo:

Suponha que você tenha um módulo em `../meu-modulo-local` e deseja usá-lo no seu projeto atual:

1. Edite o `go.mod` para adicionar uma substituição local:

```go
module github.com/usuario/meu-projeto

go 1.20

replace github.com/usuario/meu-modulo => ../meu-modulo-local
```

2. O Go agora vai buscar o código desse módulo a partir do diretório local especificado, sem precisar publicá-lo.

### **Verificando Módulos e Dependências**

Existem alguns comandos úteis para inspecionar o estado das dependências no seu projeto:

- `go list -m all`: Lista todos os módulos do projeto e suas versões.
- `go mod graph`: Exibe um gráfico de dependências para mostrar como os módulos estão relacionados.
- `go mod why`: Explica por que uma dependência específica está presente no projeto.

### **Publicando Seu Próprio Módulo**

Para publicar um módulo, basta que seu código esteja em um repositório público, como GitHub, GitLab ou Bitbucket. Após publicar o repositório, outros projetos poderão importar seu módulo pelo caminho do repositório.

#### Exemplo:

Se seu projeto estiver hospedado em `github.com/usuario/meu-projeto`, qualquer pessoa pode importá-lo assim:

```go
import "github.com/usuario/meu-projeto"
```

E o Go vai gerenciar automaticamente a instalação e versionamento desse módulo.
