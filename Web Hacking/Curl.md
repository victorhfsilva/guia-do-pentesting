# cURL

## Introdução

**cURL** (Client URL) é uma ferramenta de linha de comando usada para transferir dados de ou para um servidor usando protocolos como HTTP, HTTPS, FTP, SCP, entre outros. Ela é amplamente utilizada para realizar requisições web, automatizar interações com APIs, e testar servidores. Além disso, cURL é uma ferramenta poderosa em testes de segurança e pentests, onde pode ser usada para realizar técnicas como fuzzing, manipulação de cabeçalhos, e análise de respostas.


## Instalação do cURL

A maioria dos sistemas Linux e macOS já vêm com cURL pré-instalado. Para verificar se está disponível:

```bash
curl --version
```

Se o cURL não estiver instalado, você pode instalá-lo com os seguintes comandos:

### Linux (Debian/Ubuntu)
```bash
sudo apt-get install curl
```

### macOS (com Homebrew)
```bash
brew install curl
```

### Windows
No Windows, o cURL pode ser instalado manualmente ou usando o Windows Subsystem for Linux (WSL).

## Uso Básico do cURL

A sintaxe básica do cURL para fazer uma requisição HTTP é a seguinte:

```bash
curl <URL>
```

Exemplo:

```bash
curl https://example.com
```

Isso fará uma requisição GET à URL `https://example.com` e exibirá a resposta HTML no terminal.

### Opções Comuns

- **`-X`**: Especifica o método de requisição (GET, POST, PUT, DELETE, etc.).
- **`-d`**: Envia dados em uma requisição POST.
- **`-H`**: Define cabeçalhos HTTP personalizados.
- **`-I`**: Retorna apenas os cabeçalhos da resposta.
- **`-s`**: Modo silencioso (sem exibir barra de progresso ou erros).
- **`-o`**: Redireciona a saída para um arquivo.
- **`-L`**: Segue redirecionamentos.

## Mudando o User-Agent com cURL

O **User-Agent** é um cabeçalho HTTP enviado pelo cliente (navegador ou ferramenta) que informa ao servidor qual é o tipo de cliente que está fazendo a requisição. O cURL, por padrão, envia seu próprio User-Agent. No entanto, você pode modificá-lo para simular diferentes navegadores ou dispositivos.

### Exemplo de Mudança de User-Agent

Para modificar o **User-Agent** e simular, por exemplo, uma requisição do Google Chrome, use o seguinte comando:

```bash
curl -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36" https://example.com
```

Aqui, o `-A` ou `--user-agent` é usado para definir o User-Agent como o Google Chrome.

### Exemplos de User-Agents Comuns

- **Google Chrome**:
  ```bash
  Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
  ```

- **Mozilla Firefox**:
  ```bash
  Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
  ```

- **Mobile Safari (iPhone)**:
  ```bash
  Mozilla/5.0 (iPhone; CPU iPhone OS 14_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Mobile/15E148 Safari/604.1
  ```

## Retornando Apenas os Cabeçalhos (Headers)

Para obter apenas os cabeçalhos da resposta HTTP, você pode usar a opção `-I` (ou `--head`):

```bash
curl -I https://example.com
```

#### Exemplo de Saída:

```bash
HTTP/2 200 
date: Wed, 12 Sep 2024 14:34:12 GMT
content-type: text/html; charset=UTF-8
server: Apache
```

Essa opção é útil quando você deseja verificar informações sobre o servidor, redirecionamentos ou outros metadados sem baixar o corpo da resposta.

## Usando o Modo Silencioso com cURL

O cURL normalmente exibe uma barra de progresso e informações sobre a transferência. Para desativar essa saída adicional e tornar o comando silencioso, você pode usar a opção `-s` (silencioso):

```bash
curl -s https://example.com
```

Com isso, apenas o conteúdo da resposta será exibido, sem a barra de progresso ou mensagens de erro.

## Seguir Redirecionamentos

Alguns servidores retornam redirecionamentos (código de status 3xx) que direcionam o cliente para uma nova URL. Para fazer o cURL seguir automaticamente esses redirecionamentos, use a opção `-L`:

```bash
curl -L https://example.com
```

Com isso, o cURL seguirá até o destino final da URL.

## Enviando Dados com cURL

### Enviando Dados com Requisição POST

O cURL permite enviar dados em requisições POST usando a opção `-d`. Isso é útil para interagir com APIs ou enviar dados de formulário.

```bash
curl -X POST -d "username=user&password=pass" https://example.com/login
```

Você também pode enviar dados no formato JSON:

```bash
curl -X POST -H "Content-Type: application/json" -d '{"username":"user","password":"pass"}' https://example.com/api/login
```

### Enviando Cabeçalhos Customizados

Para adicionar cabeçalhos HTTP personalizados a uma requisição, use a opção `-H`:

```bash
curl -H "Authorization: Bearer your_token" https://example.com/protected-resource
```

Isso é útil ao fazer requisições autenticadas a APIs.

## Fuzzing com cURL

**Fuzzing** é uma técnica de teste onde dados inesperados ou aleatórios são enviados para um servidor, aplicação ou API, com o objetivo de encontrar falhas ou vulnerabilidades. O cURL pode ser utilizado para realizar fuzzing em endpoints, substituindo partes de uma URL ou payload por diferentes entradas.

### Exemplo de Fuzzing de Parâmetros

Imagine que você deseja testar diferentes valores de um parâmetro `id` em uma URL para verificar como o servidor responde:

```bash
for i in {1..100}; do
    curl -s "https://example.com/api/user?id=$i"
done
```

Esse comando fará 100 requisições consecutivas, alterando o valor do parâmetro `id` de 1 a 100.

### Fuzzing com Arquivo de Lista

Você pode usar um arquivo de lista de palavras para realizar fuzzing em pontos finais ou parâmetros. Por exemplo, você pode ter um arquivo `wordlist.txt` com possíveis nomes de usuários:

```bash
admin
guest
root
test
```

E executar o seguinte comando:

```bash
while read -r username; do
    curl -s "https://example.com/api/user?username=$username"
done < wordlist.txt
```

Esse script fará uma requisição para cada entrada no arquivo `wordlist.txt`, testando diferentes valores para o parâmetro `username`.

### Fuzzing de URLs

Você também pode realizar fuzzing em caminhos de URLs para descobrir endpoints ocultos ou não documentados:

```bash
while read -r path; do
    curl -s "https://example.com/$path"
done < urls.txt
```

Se o arquivo `urls.txt` contiver possíveis caminhos de URL, o script tentará acessá-los.

### Ferramentas de Automação de Fuzzing

Embora o cURL seja uma ferramenta poderosa para fuzzing manual, existem ferramentas dedicadas, como **ffuf** e **wfuzz**, que podem automatizar e acelerar o processo de fuzzing.

## Salvando a Saída em um Arquivo

Para salvar a resposta de uma requisição em um arquivo, você pode usar a opção `-o`:

```bash
curl -o output.html https://example.com
```

Esse comando salvará o conteúdo da URL no arquivo `output.html`.

## Verificando Certificados SSL

O cURL também permite verificar o status do certificado SSL de um site. Por exemplo, para verificar se o certificado SSL é válido, você pode usar a opção `--insecure` para pular a verificação ou a opção `-v` (verbose) para detalhes do certificado:

```bash
curl -v https://example.com
```

Isso exibirá detalhes sobre o certificado SSL do servidor.