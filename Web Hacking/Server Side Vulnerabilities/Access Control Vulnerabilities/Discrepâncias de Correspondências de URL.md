# Discrepâncias de Correspondência de URL e Controle de Acesso Quebrado

### Introdução

Sites podem variar na forma como correspondem o caminho de uma requisição recebida a um endpoint definido. Algumas variações podem incluir:

Essas discrepâncias podem resultar em falhas no controle de acesso, permitindo que usuários não autorizados acessem recursos restritos.

### Exemplos de Discrepâncias de Correspondência de URL

#### 1. Capitalização Inconsistente

Algumas aplicações toleram diferenças de capitalização em URLs. Por exemplo, uma requisição para `/ADMIN/DELETEUSER` pode ser mapeada para o endpoint `/admin/deleteUser`.

**Teste:**

1. Enviar uma requisição normal para o endpoint sensível:
   ```plaintext
   GET /admin/deleteUser HTTP/2
   Host: www.exemplo.com
   ```

2. Enviar uma requisição com capitalização diferente:
   ```plaintext
   GET /ADMIN/DELETEUSER HTTP/2
   Host: www.exemplo.com
   ```

**Objetivo:** Verificar se a aplicação trata ambos os caminhos como equivalentes e aplica o mesmo controle de acesso.

#### 2. Extensões de Arquivos Arbitrárias (Spring Framework)

No Spring Framework, a opção `useSuffixPatternMatch` permite que caminhos com extensões de arquivos arbitrárias sejam mapeados para um endpoint equivalente sem extensão.

**Teste:**

1. Enviar uma requisição normal para o endpoint:
   ```plaintext
   GET /admin/deleteUser HTTP/2
   Host: www.exemplo.com
   ```

2. Enviar uma requisição com uma extensão arbitrária:
   ```plaintext
   GET /admin/deleteUser.anything HTTP/2
   Host: www.exemplo.com
   ```

**Objetivo:** Verificar se a aplicação trata ambos os caminhos como equivalentes e aplica o mesmo controle de acesso.

#### 3. Barras Finais

Alguns sistemas podem tratar `/admin/deleteUser` e `/admin/deleteUser/` como endpoints distintos. Adicionar ou remover uma barra final pode permitir o bypass de controles de acesso.

**Teste:**

1. Enviar uma requisição normal para o endpoint:
   ```plaintext
   GET /admin/deleteUser HTTP/2
   Host: www.exemplo.com
   ```

2. Enviar uma requisição com uma barra final:
   ```plaintext
   GET /admin/deleteUser/ HTTP/2
   Host: www.exemplo.com
   ```

**Objetivo:** Verificar se a aplicação trata ambos os caminhos como equivalentes e aplica o mesmo controle de acesso.

### Análise de Resultados

- **Acesso Permitido:** Se a aplicação permitir o acesso aos recursos sensíveis quando há discrepâncias de URL, isso indica uma falha no controle de acesso. A aplicação deve tratar todas as variações de URL de forma consistente e aplicar as mesmas restrições.
- **Acesso Negado:** Se a aplicação negar o acesso quando há discrepâncias de URL, isso sugere que os controles de acesso estão corretamente implementados.

### Conclusão

Discrepâncias na correspondência de URLs podem causar falhas significativas no controle de acesso em aplicações web. Seguindo este guia, você pode sistematicamente testar e identificar falhas de controle de acesso resultantes de variações na capitalização, uso de extensões arbitrárias e barras finais. Certifique-se de que sua aplicação trata todas as variações de URL de maneira consistente para manter a segurança.