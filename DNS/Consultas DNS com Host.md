# `host`

## Introdução

O comando **`host`** é uma ferramenta de linha de comando usada para realizar consultas de DNS (Domain Name System). Ele é útil para resolver nomes de domínio para endereços IP, obter informações sobre servidores DNS, verificar registros MX (Mail Exchange), e muito mais. O **`host`** é amplamente utilizado por administradores de sistemas, engenheiros de rede e profissionais de segurança para realizar diagnósticos e auditorias de rede.

## Instalação do Comando `host`

### Linux

A maioria das distribuições Linux já vem com o comando `host` pré-instalado. Se ele não estiver instalado, você pode instalá-lo com o pacote **`dnsutils`**:

- **Debian/Ubuntu**:
  ```bash
  sudo apt-get install dnsutils
  ```

- **CentOS/RHEL**:
  ```bash
  sudo yum install bind-utils
  ```

### macOS

No macOS, o `host` geralmente está pré-instalado. Para verificar, basta executar o comando:

```bash
host -v
```

Se o `host` não estiver disponível, ele pode ser instalado via Homebrew:

```bash
brew install bind
```

## Usos Básicos do Comando `host`

A sintaxe básica do comando `host` é:

```bash
host <nome_do_domínio>
```

###  Resolver Nome de Domínio para IP

Para resolver um nome de domínio para o endereço IP correspondente, basta executar o comando com o nome do domínio:

```bash
host example.com
```

#### Exemplo de Saída:
```bash
example.com has address 93.184.216.34
example.com has IPv6 address 2606:2800:220:1:248:1893:25c8:1946
```

Neste exemplo, o `host` retorna o endereço IPv4 e IPv6 do domínio `example.com`.

### Resolver Endereço IP para Nome de Domínio (PTR Lookup)

Para resolver um endereço IP para seu nome de domínio correspondente (consulta PTR ou inversa), use:

```bash
host <endereço_ip>
```

#### Exemplo:
```bash
host 8.8.8.8
```

#### Exemplo de Saída:
```bash
8.8.8.8.in-addr.arpa domain name pointer dns.google.
```

Neste exemplo, o IP `8.8.8.8` é resolvido para o domínio `dns.google`.

## Consultas de Registros DNS Específicos

O comando `host` permite consultar diferentes tipos de registros DNS, como **A**, **MX**, **NS**, e **TXT**. Aqui estão alguns exemplos práticos de como realizar essas consultas.

### Consultar Registros A (Endereço IPv4)

Os registros **A** associam um nome de domínio a um endereço IPv4. Para consultar os registros A de um domínio:

```bash
host -t A example.com
```

#### Exemplo de Saída:
```bash
example.com has address 93.184.216.34
```

### Consultar Registros AAAA (Endereço IPv6)

Os registros **AAAA** são usados para associar um nome de domínio a um endereço IPv6. Para consultar os registros AAAA:

```bash
host -t AAAA example.com
```

#### Exemplo de Saída:
```bash
example.com has IPv6 address 2606:2800:220:1:248:1893:25c8:1946
```

### Consultar Registros MX (Mail Exchange)

Os registros **MX** definem os servidores de e-mail responsáveis por receber emails para o domínio. Para consultar os registros MX:

```bash
host -t MX example.com
```

#### Exemplo de Saída:
```bash
example.com mail is handled by 10 mail.example.com.
```

### Consultar Registros NS (Name Server)

Os registros **NS** apontam para os servidores de nome (DNS) responsáveis por resolver o domínio. Para consultar os registros NS:

```bash
host -t NS example.com
```

#### Exemplo de Saída:
```bash
example.com name server ns1.example.com.
example.com name server ns2.example.com.
```

###  Consultar Registros TXT

Os registros **TXT** armazenam informações de texto associadas a um domínio, como as entradas de verificação de domínio (DKIM, SPF). Para consultar os registros TXT:

```bash
host -t TXT example.com
```

#### Exemplo de Saída:
```bash
example.com descriptive text "v=spf1 include:_spf.google.com ~all"
```

### Execução de Transferência de zona

Após obter os Name Servers de um domínio é possível efetuar a transferência de zona com um comando similar ao abaixo.

```shell
host -l -a example.com ns2.example.com.br
```

Isto é útil em cenários de teste de segurança pois a resposta inclui todos os subdomínios deste domínio.
#### Como Funciona o Zone Transfer

1. **Solicitação de Transferência**: O servidor secundário envia uma solicitação de transferência para o servidor primário.
2. **Autorização**: O servidor primário verifica se a solicitação é de um servidor autorizado a receber a transferência. Isso é importante para evitar que dados DNS sejam expostos a servidores não confiáveis.
3. **Envio de Dados**: Dependendo do tipo de transferência (AXFR ou IXFR), o servidor primário envia os registros DNS ao secundário.
4. **Sincronização**: O servidor secundário atualiza seus registros DNS com os dados recebidos, garantindo que ambos os servidores autoritativos tenham a mesma informação.
#### Como Verificar qual é o Servidor Primário

Para verificar qual é o servidor primário, você pode consultar o registro SOA do domínio:

```bash
host -t soa businesscorp.com.br
```

Este comando retornará o registro SOA, que inclui o nome do servidor primário. O servidor listado como "MNAME" no registro SOA é considerado o servidor primário.

## Especificando Servidor DNS para a Consulta

Por padrão, o comando `host` usa o servidor DNS configurado no sistema. No entanto, você pode especificar um servidor DNS diferente para realizar a consulta.

### Usando um Servidor DNS Personalizado

Para usar um servidor DNS específico na consulta, adicione o endereço IP do servidor DNS ao final do comando:

```bash
host example.com 8.8.8.8
```

Neste exemplo, a consulta é feita usando o servidor DNS público do Google (`8.8.8.8`).

## Consultas Verbosas

Para obter mais detalhes sobre a consulta de DNS, você pode usar o modo verboso com a opção `-v`:

```bash
host -v example.com
```

Esse comando exibe mais informações sobre o processo de resolução, como detalhes sobre o cache DNS, servidores de nome e mais.

## Consultas Recursivas

Para realizar uma consulta recursiva e buscar os servidores de nome autorizados para um domínio, use a opção `-r`:

```bash
host -r example.com
```

Isso forçará o `host` a continuar a consulta até encontrar uma resposta final diretamente dos servidores de nome autoritativos.

## Exibir Apenas a Resposta Final

Se você quiser que o comando `host` exiba apenas a resposta final da consulta (suprimindo os resultados intermediários), use a opção `-W`:

```bash
host -W example.com
```
