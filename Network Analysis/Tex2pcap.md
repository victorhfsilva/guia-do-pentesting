# Text2pcap

**Text2pcap** é uma ferramenta poderosa incluída no conjunto de ferramentas do Wireshark, usada para converter dados de pacotes capturados em formato de texto (ASCII ou hexadecimal) para o formato `.pcap` (Packet Capture). Esse formato `.pcap` é o padrão utilizado por ferramentas como Wireshark e tcpdump para análise de pacotes de rede. O **Text2pcap** é particularmente útil quando você tem logs de pacotes ou dados de rede em formato de texto e deseja analisá-los no Wireshark.

## Instalação do Text2pcap

O Text2pcap vem com o Wireshark, então, se você já tem o Wireshark instalado, você já deve ter o Text2pcap disponível. Ele pode ser acessado através da linha de comando.

- **Instalação no Linux**:
  Se o Wireshark não estiver instalado, você pode instalá-lo juntamente com o Text2pcap usando o gerenciador de pacotes da sua distribuição:
  ```bash
  sudo apt-get install wireshark
  ```

## Usos Comuns do Text2pcap

### Conversão de Dados Hexadecimais

Text2pcap é frequentemente usado para converter strings hexadecimais representando pacotes de rede em um arquivo `.pcap`, que pode ser aberto no Wireshark para análise detalhada.

### Conversão de Logs ASCII

Text2pcap também pode ser usado para converter logs ASCII, onde os pacotes são representados em um formato legível por humanos, para `.pcap`.

## Estrutura de um Arquivo de Texto para Text2pcap

Para que o Text2pcap possa converter corretamente o arquivo de texto em um `.pcap`, o arquivo de texto deve estar em um formato específico. Existem duas formas principais de estruturar esses arquivos:

### Formato Hexadecimal Simples

Neste formato, os dados dos pacotes são representados diretamente em hexadecimal, geralmente com um endereço de offset no início de cada linha, seguido pelos bytes em hexadecimal.

**Exemplo**:
```plaintext
0000  45 00 00 3c 1c 46 40 00 40 06 b1 e6 c0 a8 00 68
0010  c0 a8 00 01 00 14 1f 90 0f 9a a5 ec 00 00 00 00
0020  50 02 20 00 56 b4 00 00 00 00 00 00 00 00 00 00
0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00
```

### Formato ASCII com Endereços e Bytes

Aqui, as linhas contêm um endereço de offset seguido pelos bytes em hexadecimal, que podem ser seguidos por uma representação ASCII dos bytes.

**Exemplo**:
```plaintext
0000  45 00 00 3c 1c 46 40 00 40 06 b1 e6 c0 a8 00 68  E..<.F@.@....h
0010  c0 a8 00 01 00 14 1f 90 0f 9a a5 ec 00 00 00 00  ................
0020  50 02 20 00 56 b4 00 00 00 00 00 00 00 00 00 00  P. .V...........
0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00        ..............
```

## Usando o Text2pcap

### Sintaxe Básica

A sintaxe básica do Text2pcap é:

```bash
text2pcap [opções] arquivo_texto arquivo_pcap
```

Onde:
- `arquivo_texto` é o arquivo que contém os dados em formato de texto.
- `arquivo_pcap` é o arquivo de saída em formato `.pcap`.

### Exemplo de Conversão

Para converter um arquivo de texto chamado `dados.txt` para um arquivo `.pcap` chamado `saida.pcap`, você usaria o comando:

```bash
text2pcap dados.txt saida.pcap
```

### Especificando o Link-Layer

Por padrão, o Text2pcap assume que os dados de link-layer são Ethernet. Se os dados capturados pertencem a outro tipo de link-layer, você pode especificá-lo usando a opção `-l`:

```bash
text2pcap -l 101 dados.txt saida.pcap
```
Onde `-l 101` especifica que o link-layer é PPP (Point-to-Point Protocol).

### Definindo o Protocolo de Camada de Rede

Se o conteúdo do pacote começar diretamente com um cabeçalho de camada de rede, como IP ou ARP, você pode usar a opção `-n` para especificar o protocolo:

```bash
text2pcap -n 0x0800 dados.txt saida.pcap
```

Onde `0x0800` especifica que o protocolo é IPv4.

### Definindo os Timestamps

Você também pode adicionar timestamps aos pacotes usando a opção `-t`:

```bash
text2pcap -t "%H:%M:%S." dados.txt saida.pcap
```
