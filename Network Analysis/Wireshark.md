# Filtros do Wireshark

O **Wireshark** é uma das ferramentas mais poderosas e amplamente utilizadas para captura e análise de tráfego de rede. No entanto, a quantidade de dados capturados pode ser avassaladora, e é aí que entram os filtros do Wireshark. Os filtros ajudam a isolar o tráfego relevante, permitindo uma análise mais eficiente e focada.

## Tipos de Filtros no Wireshark

### Filtros de Captura

- **Definição**: Filtros de captura são aplicados durante a captura de pacotes e definem quais pacotes serão armazenados para análise. Isso ajuda a reduzir o volume de dados capturados, focando apenas no tráfego de interesse.
- **Sintaxe**: A sintaxe dos filtros de captura é baseada na linguagem **BPF (Berkeley Packet Filter)**.
- **Exemplo de Uso**: 
  - Capturar apenas tráfego ICMP:
    ```plaintext
    icmp
    ```
  - Capturar tráfego de e para um endereço IP específico:
    ```plaintext
    host 192.168.1.1
    ```
  - Capturar tráfego HTTP:
    ```plaintext
    port 80
    ```

### Filtros de Exibição

- **Definição**: Filtros de exibição são aplicados após a captura de pacotes e afetam apenas a forma como os pacotes são exibidos no Wireshark. Eles não alteram o que foi capturado, mas permitem filtrar o tráfego visualizado, facilitando a análise.
- **Sintaxe**: A sintaxe dos filtros de exibição é baseada na linguagem própria do Wireshark.
- **Exemplo de Uso**: 
  - Exibir apenas pacotes TCP:
    ```plaintext
    tcp
    ```
  - Exibir pacotes enviados de um endereço IP específico:
    ```plaintext
    ip.src == 192.168.1.1
    ```
  - Exibir pacotes contendo um certo texto no payload:
    ```plaintext
    frame contains "login"
    ```

## Filtros de Captura: Exemplos e Aplicações

### Captura de Tráfego por Protocolo

- **Capturar Apenas Tráfego TCP**:
  ```plaintext
  tcp
  ```
- **Capturar Apenas Tráfego HTTP**:
  ```plaintext
  tcp port 80
  ```
- **Capturar Apenas Tráfego ICMP (como pings)**:
  ```plaintext
  icmp
  ```

### Captura de Tráfego por Endereço IP

- **Capturar Tráfego de um Endereço IP Específico**:
  ```plaintext
  host 192.168.1.1
  ```
- **Capturar Tráfego entre Dois Endereços IP Específicos**:
  ```plaintext
  host 192.168.1.1 and host 192.168.1.2
  ```
- **Capturar Tráfego de uma Sub-rede Específica**:
  ```plaintext
  net 192.168.1.0/24
  ```

### Captura de Tráfego por Porta

- **Capturar Tráfego para uma Porta Específica**:
  ```plaintext
  port 443
  ```
- **Capturar Tráfego TCP para um Intervalo de Portas**:
  ```plaintext
  tcp portrange 1000-2000
  ```

## Filtros de Exibição: Exemplos e Aplicações

### Exibição por Protocolo

- **Exibir Apenas Pacotes DNS**:
  ```plaintext
  dns
  ```
- **Exibir Apenas Pacotes ARP**:
  ```plaintext
  arp
  ```

### Exibição por Endereço IP

- **Exibir Pacotes Enviados de um Endereço IP Específico**:
  ```plaintext
  ip.src == 192.168.1.1
  ```
- **Exibir Pacotes Recebidos por um Endereço IP Específico**:
  ```plaintext
  ip.dst == 192.168.1.1
  ```
- **Exibir Pacotes Entre Dois Endereços IP**:
  ```plaintext
  ip.src == 192.168.1.1 && ip.dst == 192.168.1.2
  ```
Ou,
  ```plaintext
  ip.addr == 192.168.1.1 && ip.addr == 192.168.1.2
  ```
### Exibição por Porta

- **Exibir Pacotes HTTP**:
  ```plaintext
  tcp.port == 80
  ```
- **Exibir Pacotes HTTPS**:
  ```plaintext
  tcp.port == 443
  ```

### Exibição por Texto Contido no Payload

- **Exibir Pacotes Contendo um Texto Específico**:
  ```plaintext
  frame contains "password"
  ```

### Exibição por flags

- **Exibir pacotes com flag FIN:**
```bash
tcp.flags.fin == 1 
```

- **Exibir pacotes com flag ACK:**
```bash
tcp.flags.ack == 1 
```

- **Exibir pacotes com flag SYN:**
```bash
tcp.flags.ack == 1 
```

Os filtros de flags são uteis para analisar as respostas de um servidor a scanners de portas. As portas abertas geralmente retornam SYN, ACK ou FIN, ACK; enquanto as portas fechadas geralmente retornam RST, ACK.

### Exibição de Erros ou Pacotes Inválidos

- **Exibir Pacotes com Erros TCP**:
  ```plaintext
  tcp.analysis.flags
  ```
- **Exibir Pacotes com Retransmissões**:
  ```plaintext
  tcp.analysis.retransmission
  ```

### Filtros Avançados e Combinações

#### Combinação de Filtros

- **Exibir Pacotes que Satisfazem Vários Critérios** (AND):
  ```plaintext
  ip.src == 192.168.1.1 && tcp.port == 80
  ```
- **Exibir Pacotes que Satisfazem Qualquer Um de Vários Critérios** (OR):
  ```plaintext
  tcp.port == 80 || tcp.port == 443
  ```

#### Exclusão de Pacotes

- **Exibir Pacotes que Não Contêm um Critério Específico** (NOT):
  ```plaintext
  !arp
  ```
- **Exibir Pacotes que Não Vieram de um Determinado IP**:
  ```plaintext
  !ip.src == 192.168.1.1
  ```

#### Filtragem por Tamanho de Pacote

- **Exibir Pacotes Maiores que um Tamanho Específico**:
  ```plaintext
  frame.len > 1000
  ```
- **Exibir Pacotes Menores ou Iguais a um Tamanho Específico**:
  ```plaintext
  frame.len <= 128
  ```

### Salvando e Reutilizando Filtros

#### Salvando Filtros de Exibição

O Wireshark permite salvar filtros de exibição para reutilização futura, o que é útil para análises repetitivas.

- **Salvar um Filtro**:
  - Após inserir um filtro na barra de filtros, clique no ícone de “+” ao lado do campo de filtro.
  - Dê um nome ao filtro e salve.

#### Reutilizando Filtros Salvos

- **Aplicar Filtro Salvo**:
  - Clique na barra de filtro e selecione o filtro salvo na lista de filtros disponíveis.
