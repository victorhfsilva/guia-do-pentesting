# Trabalhando com Registro e Eventos no PowerShell

O PowerShell oferece uma gama de cmdlets que permitem a manipulação direta do Registro do Windows e a coleta e monitoramento de eventos do sistema. Esses recursos são importantes para administradores que precisam gerenciar configurações do sistema e monitorar logs de eventos de forma automatizada.

### Trabalhando com o Registro do Windows

O Registro do Windows é um banco de dados hierárquico que armazena configurações e opções do sistema operacional e de aplicativos. No PowerShell, podemos manipular o Registro utilizando cmdlets como `Get-Item`, `Set-Item`, `Remove-Item`, e outros específicos para registros.

####  Navegar pelo Registro com `Get-Item`

O cmdlet `Get-Item` permite acessar e visualizar chaves e valores de registro.

##### Exemplo:
```powershell
# Navegar até uma chave do Registro
Get-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion"
```
Aqui, o caminho `HKLM:\` refere-se ao Hive `HKEY_LOCAL_MACHINE`. Você também pode usar outras raízes, como `HKCU:\` para `HKEY_CURRENT_USER`.

#### Modificar Chaves do Registro com `Set-Item` e `Set-ItemProperty`

`Set-Item` é usado para modificar as chaves do Registro, enquanto `Set-ItemProperty` modifica propriedades ou valores em chaves de registro existentes.

##### Exemplo: Alterar um valor no registro
```powershell
# Alterar o valor de uma propriedade de registro
Set-ItemProperty -Path "HKCU:\Software\MinhaApp" -Name "Config" -Value "NovoValor"
```

#### Criar Chaves e Valores com `New-Item` e `New-ItemProperty`

`New-Item` é usado para criar novas chaves no Registro, e `New-ItemProperty` é usado para adicionar novos valores a uma chave existente.

##### Exemplo: Criar uma nova chave e valor
```powershell
# Criar uma nova chave no registro
New-Item -Path "HKCU:\Software\MinhaApp"

# Adicionar um valor à chave recém-criada
New-ItemProperty -Path "HKCU:\Software\MinhaApp" -Name "Config" -Value "ValorInicial" -PropertyType String
```

#### Remover Chaves ou Valores com `Remove-Item` e `Remove-ItemProperty`

`Remove-Item` exclui chaves inteiras do Registro, enquanto `Remove-ItemProperty` remove valores individuais.

##### Exemplo: Remover uma chave ou valor
```powershell
# Remover uma chave de registro
Remove-Item -Path "HKCU:\Software\MinhaApp" -Recurse

# Remover um valor específico de uma chave de registro
Remove-ItemProperty -Path "HKCU:\Software\MinhaApp" -Name "Config"
```
---

### Trabalhando com Eventos do Sistema

O PowerShell também oferece cmdlets para trabalhar com logs de eventos do sistema, como `Get-EventLog` e `Get-WinEvent`. Esses cmdlets permitem a leitura, filtragem e monitoramento de eventos gerados pelo sistema operacional ou por aplicativos.

#### Coletar Eventos com `Get-EventLog`

`Get-EventLog` permite acessar os eventos de logs legados do sistema. É útil para consultar logs como "Application", "System" e "Security".

##### Exemplo: Listar eventos do log de sistema
```powershell
# Obter os últimos 10 eventos do log de sistema
Get-EventLog -LogName System -Newest 10
```

##### Filtrar eventos por tipo e origem:
```powershell
# Filtrar por eventos de erro
Get-EventLog -LogName System -EntryType Error

# Filtrar por eventos de um determinado aplicativo ou serviço
Get-EventLog -LogName Application -Source "Winlogon"
```

#### Coletar Eventos com `Get-WinEvent`

`Get-WinEvent` é um cmdlet mais avançado que pode acessar tanto logs de eventos legados quanto os mais modernos (como os logs da vista "Applications and Services").

##### Exemplo: Coletar eventos com `Get-WinEvent`
```powershell
# Obter os 10 eventos mais recentes do log de Aplicações
Get-WinEvent -LogName "Application" -MaxEvents 10
```

##### Filtrar eventos por ID:
```powershell
# Filtrar eventos por um ID específico
Get-WinEvent -LogName "System" -FilterHashtable @{Id=6005}
```

##### Usar XPath para filtragem avançada:
`Get-WinEvent` também suporta consultas XPath para filtragem de eventos mais complexa.
```powershell
# Filtrar por eventos usando XPath
Get-WinEvent -LogName "System" -FilterXPath "*[System[EventID=6005]]"
```

#### Monitorar Logs de Eventos em Tempo Real

Você pode configurar scripts para monitorar eventos em tempo real, especialmente útil para monitorar logs críticos.

##### Exemplo: Monitorar eventos em tempo real
```powershell
# Monitorar eventos do log de sistema em tempo real
Get-WinEvent -LogName "System" | ForEach-Object {
    Write-Host "Novo evento: $($_.Message)"
}
```