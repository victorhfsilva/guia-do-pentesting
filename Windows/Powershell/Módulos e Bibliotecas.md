
# Módulos e Bibliotecas no PowerShell

Os módulos no PowerShell são pacotes que contêm conjuntos de funções, cmdlets, variáveis e outros componentes, que estendem as funcionalidades nativas do PowerShell. Você pode instalar, importar e explorar esses módulos para automatizar tarefas específicas e acessar funcionalidades adicionais.

### Instalação de Módulos

Para obter módulos adicionais, o PowerShell oferece suporte à PowerShell Gallery, uma repositório online que contém diversos módulos prontos para uso. O cmdlet principal para instalação é o `Install-Module`.

#### Instalando Módulos com `Install-Module`

`Install-Module` baixa e instala módulos da PowerShell Gallery, tornando-os disponíveis para uso em seu sistema.

##### Exemplo de instalação:
```powershell
# Instalar um módulo específico, como o Azure PowerShell
Install-Module -Name Az -Repository PSGallery
```

Neste exemplo, o módulo `Az` (usado para interagir com o Azure) é instalado a partir da PowerShell Gallery.

#### Parâmetros Úteis de `Install-Module`

- **`-Scope`**: Define se o módulo será instalado apenas para o usuário atual ou para todos os usuários do sistema.
  
  - Para instalar apenas para o usuário atual:
    ```powershell
    Install-Module -Name Az -Scope CurrentUser
    ```

- **`-Force`**: Ignora confirmações e instala ou substitui módulos sem pedir interação do usuário.

  - Forçar a instalação:
    ```powershell
    Install-Module -Name Az -Force
    ```

- **`-AllowClobber`**: Permite substituir cmdlets já existentes se outro módulo já estiver utilizando o mesmo nome.

#### Verificar Módulos Instalados com `Get-InstalledModule`

Após instalar um módulo, você pode verificar os módulos instalados com `Get-InstalledModule`:

```powershell
# Listar todos os módulos instalados
Get-InstalledModule
```

---

### Importação de Módulos

Uma vez que o módulo está instalado, você pode carregá-lo no ambiente do PowerShell com o cmdlet `Import-Module`. Isso disponibiliza os cmdlets e funções do módulo para uso imediato.

### Usar `Import-Module`

`Import-Module` carrega um módulo instalado no ambiente de execução do PowerShell, tornando seus comandos disponíveis na sessão atual.

##### Exemplo de importação:
```powershell
# Importar o módulo Az para a sessão atual
Import-Module -Name Az
```

#### Carregamento Automático de Módulos

No PowerShell moderno (v5 e acima), os módulos são carregados automaticamente na primeira vez que um cmdlet do módulo é chamado. Portanto, muitas vezes você não precisa usar explicitamente `Import-Module`.

#### Verificar Módulos Importados com `Get-Module`

Você pode verificar os módulos atualmente carregados na sua sessão com `Get-Module`:

```powershell
# Listar módulos carregados na sessão atual
Get-Module
```

---

### Explorando Comandos de Módulos

Depois de instalar e importar um módulo, você pode explorar os novos cmdlets e funções que ele oferece. Isso permite que você aprenda a usar as funcionalidades adicionais fornecidas pelo módulo.

#### Listar Cmdlets de um Módulo com `Get-Command`

`Get-Command` permite listar todos os cmdlets disponíveis de um módulo específico.

##### Exemplo:
```powershell
# Listar todos os cmdlets do módulo Az
Get-Command -Module Az
```

#### Obter Detalhes de Cmdlets com `Get-Help`

Depois de identificar os cmdlets disponíveis em um módulo, você pode usar o cmdlet `Get-Help` para obter mais detalhes sobre como usar cada cmdlet.

##### Exemplo:
```powershell
# Obter ajuda sobre o cmdlet Get-AzVM do módulo Az
Get-Help Get-AzVM
```

Você pode usar o parâmetro `-Full` para obter informações completas, incluindo exemplos:

```powershell
Get-Help Get-AzVM -Full
```

#### Atualizar Módulos com `Update-Module`

Os módulos instalados podem ser atualizados para versões mais recentes com o cmdlet `Update-Module`.

##### Exemplo de atualização:
```powershell
# Atualizar o módulo Az para a versão mais recente
Update-Module -Name Az
```

#### Remover Módulos com `Uninstall-Module`

Se você não precisar mais de um módulo instalado, pode removê-lo usando o cmdlet `Uninstall-Module`.

##### Exemplo de desinstalação:
```powershell
# Remover o módulo Az
Uninstall-Module -Name Az
```
