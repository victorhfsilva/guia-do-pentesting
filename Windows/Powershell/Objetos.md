# Objetos no PowerShell

O PowerShell é uma linguagem de script orientada a objetos, o que significa que a maioria dos elementos manipulados no PowerShell são objetos. Diferente de outras linguagens baseadas em texto, o PowerShell lida com objetos e seus membros (propriedades e métodos), permitindo uma manipulação rica e estruturada de dados.


### **O que são objetos no PowerShell?**

No PowerShell, **tudo é um objeto**: cada saída de um cmdlet ou função é um objeto com propriedades e métodos associados. Um objeto no PowerShell é uma instância de uma classe, que encapsula dados (propriedades) e comportamentos (métodos).

Por exemplo, quando você executa o comando `Get-Process`, o PowerShell retorna uma lista de objetos de processo. Cada um desses objetos contém propriedades como `Name`, `ID`, `CPU`, entre outras.

### **Propriedades e Métodos dos Objetos**

- **Propriedades**: São características do objeto que armazenam informações. Por exemplo, o nome de um processo é uma propriedade do objeto de processo.

- **Métodos**: São ações que podem ser realizadas com o objeto. Por exemplo, um método pode ser usado para parar ou iniciar um processo.

**Exemplo**:

```powershell
$process = Get-Process -Name "notepad"
$process.Name         # Exibe o nome do processo
$process.Id           # Exibe o ID do processo
$process.Kill()       # Método para finalizar o processo
```

Neste exemplo, `Name` e `Id` são **propriedades**, e `Kill()` é um **método**.

### **Manipulação de Objetos com Cmdlets**

Vários cmdlets no PowerShell são projetados especificamente para trabalhar com objetos. Vamos explorar os mais comuns:

#### **Get-Member**

O cmdlet `Get-Member` permite inspecionar os membros (propriedades e métodos) de um objeto.

**Sintaxe:**

```powershell
Get-Process | Get-Member
```

Isso listará todas as propriedades e métodos dos objetos retornados pelo `Get-Process`.

#### **Select-Object**

`Select-Object` permite selecionar propriedades específicas de um objeto.

**Sintaxe:**

```powershell
Get-Process | Select-Object Name, Id, CPU
```

Isso exibirá apenas as propriedades `Name`, `Id` e `CPU` dos processos.


#### **Where-Object**

`Where-Object` é usado para filtrar objetos com base em uma condição.

**Sintaxe:**

```powershell
Get-Process | Where-Object {$_.CPU -gt 100}
```

Isso retorna todos os processos que estão consumindo mais de 100 unidades de CPU. A variável `$_` faz referência ao objeto atual no pipeline.

---

### **Criando Seus Próprios Objetos**

Você pode criar objetos personalizados no PowerShell usando o cmdlet `New-Object` ou usando a sintaxe simplificada com `[PSCustomObject]`.

**Exemplo:**

```powershell
$meuObjeto = [PSCustomObject]@{
    Nome = "Computador01"
    Processador = "Intel"
    Memoria = "16GB"
}

$meuObjeto
```

Isso cria um objeto personalizado com as propriedades `Nome`, `Processador` e `Memoria`.


### **Pipeline de Objetos**

Um dos aspectos mais poderosos do PowerShell é o pipeline, que permite que você passe objetos de um cmdlet para outro. Diferente de shells tradicionais que passam texto, o PowerShell passa **objetos completos**.

**Exemplo**:

```powershell
Get-Service | Where-Object {$_.Status -eq 'Running'} | Select-Object Name, Status
```

Aqui, `Get-Service` passa objetos de serviço para `Where-Object`, que filtra apenas os que estão em execução, e depois `Select-Object` exibe apenas as propriedades `Name` e `Status`.


### **Cmdlets Úteis para Trabalhar com Objetos**

#### **Format-List**

Exibe as propriedades dos objetos em formato de lista.

**Exemplo:**

```powershell
Get-Process | Format-List *
```

Exibe todas as propriedades do objeto em formato de lista.

#### **Format-Table**

Exibe as propriedades dos objetos em formato de tabela.

**Exemplo:**

```powershell
Get-Process | Format-Table Name, Id, CPU
```

Exibe uma tabela com as propriedades `Name`, `Id` e `CPU`.

#### **Sort-Object**

Ordena objetos com base em uma ou mais propriedades.

**Exemplo:**

```powershell
Get-Process | Sort-Object CPU
```

Ordena os processos com base no uso da CPU.

#### **Out-File**

Salva a saída em um arquivo de texto.

**Exemplo:**

```powershell
Get-Process | Out-File "C:\processos.txt"
```
