# Funções no PowerShell

As funções no PowerShell são blocos de código reutilizáveis que permitem automatizar tarefas e organizar o código de forma mais eficiente. Elas são amplamente usadas para criar scripts modulares e bem organizados.

#### Definição de Funções

Uma função no PowerShell é definida usando a palavra-chave `function` seguida pelo nome da função e um bloco de código entre chaves `{}`. Essa estrutura permite encapsular código que pode ser reutilizado em diferentes partes do script.

##### Exemplo de uma função simples:
```powershell
function MyFunction {
    Write-Host "Esta é uma função personalizada."
}
```
Aqui, ao chamar `MyFunction`, o PowerShell executa o código dentro do bloco e exibe a mensagem "Esta é uma função personalizada."

##### Chamando a função:
```powershell
MyFunction
```

#### Parâmetros de Funções

As funções no PowerShell podem receber parâmetros que permitem passar dados para elas durante a execução. Isso é feito utilizando o bloco `param()` ou o atributo `[Parameter()]`.

##### Exemplo usando `param()`:
```powershell
function GreetUser {
    param ($Name)
    Write-Host "Olá, $Name!"
}
```
Neste exemplo, ao chamar a função, você pode fornecer um nome como parâmetro:
```powershell
GreetUser -Name "Victor"
```
Saída: 
```
Olá, Victor!
```

##### Exemplo usando `[Parameter()]`:
Você também pode definir parâmetros mais complexos usando o atributo `[Parameter()]`, o que permite especificar características adicionais como parâmetros obrigatórios ou posicionais.
```powershell
function GreetUser {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
        [string]$Name
    )
    Write-Host "Olá, $Name!"
}
```
Aqui, o parâmetro `Name` é obrigatório. Caso não seja fornecido, o PowerShell solicitará que o usuário insira um valor.

##### Chamando a função:
```powershell
GreetUser -Name "João"
```

#### Funções Avançadas

Funções avançadas permitem adicionar validações e funcionalidades mais complexas. Um exemplo comum é definir funções que têm parâmetros obrigatórios, validação de entrada e retorno de saída estruturada.

##### Exemplo com parâmetros obrigatórios e validação:
```powershell
function CalculateSquareRoot {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
        [ValidateRange(1, 1000)]  # Validação para limitar o valor entre 1 e 1000
        [int]$Number
    )

    $result = [math]::Sqrt($Number)
    Write-Host "A raiz quadrada de $Number é $result."
}
```
Neste exemplo, o parâmetro `$Number` é obrigatório e é validado para garantir que o número esteja entre 1 e 1000. Caso o valor fornecido não esteja dentro do intervalo, um erro será lançado.

##### Chamando a função:
```powershell
CalculateSquareRoot -Number 25
```
Saída:
```
A raiz quadrada de 25 é 5
```

#### Retorno de Valores em Funções

As funções podem retornar valores, permitindo que os resultados sejam utilizados em outros blocos de código ou armazenados em variáveis.

##### Exemplo de função que retorna valores:
```powershell
function GetSum {
    param ($a, $b)
    return $a + $b
}

# Armazenando o resultado em uma variável
$result = GetSum -a 5 -b 10
Write-Host "A soma é: $result"
```
Neste caso, a função `GetSum` retorna a soma dos dois parâmetros fornecidos.

#### Funções com Múltiplos Parâmetros

Você pode passar múltiplos parâmetros para uma função, seja de forma nomeada ou posicional. As funções suportam tanto valores obrigatórios quanto opcionais.

##### Exemplo com múltiplos parâmetros:
```powershell
function MultiplyNumbers {
    param ($a, $b, $c = 1)  # $c é opcional e tem um valor padrão
    return $a * $b * $c
}

# Chamando a função
$result1 = MultiplyNumbers -a 2 -b 3
$result2 = MultiplyNumbers -a 2 -b 3 -c 4

Write-Host "Resultado 1: $result1"  # Resultado 1: 6
Write-Host "Resultado 2: $result2"  # Resultado 2: 24
```

####  Funções com Saída Personalizada

Funções também podem retornar objetos personalizados, permitindo que você manipule dados de forma estruturada, como no exemplo a seguir:

```powershell
function CreatePerson {
    param ($FirstName, $LastName)
    
    $person = [PSCustomObject]@{
        FirstName = $FirstName
        LastName  = $LastName
    }

    return $person
}

# Chamando a função
$person = CreatePerson -FirstName "Maria" -LastName "Silva"
$person
```
Isso retorna um objeto contendo as propriedades `FirstName` e `LastName`.