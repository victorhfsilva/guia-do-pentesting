# My Personal Methodology

## Reconhecimento 

### Coleta de Informações passiva

1. Buscar por informações sensíveis utilizando Google Dorking, algumas pesquisas úteis são:
	- Busca por leaks no pastebin.
	- Busca por repositórios públicos no Github.
	- Busca por diferentes extensões de arquivo. Pode ser útil analisar os metadados destes arquivos com ExifTool.
	- Busca por páginas de indexação de arquivos.
	- Busca por outros domíniors.
2. Parte desta busca utilizando Google Dorks pode ser automatizada pelo `theharvester`.
3. Busca por informações sensíveis no Github caso o alvo possua um repositório público, pode ser útil usar ferramentas como `gitleaks`  e `gitrop`.
4. Buscar por emails e mídias sociais nos sites.
5. Investigar o domínio do alvo com `whois dominio.com` ou nos sites `https://www.iana.org/whois`, `https://client.rdap.org/`. Alguns dados úteis são:
	 - Dados pessoais dos responsáveis;
	 - Name Servers.
6. Investigar o endereço ip do alvo com reverse lookup `whois 37.59.174.225` ou no site `https://client.rdap.org/`. Alguns dados úteis são:
	- Bloco de Rede;
	- Host do IP.
7. Caso a empresa possua um AS próprio é possível consultar seus dados em `https://bgpview.io/`
8. Através do endereço do bloco de rede do alvo é possível obter os domínios de cada endereço IP do bloco de rede através da busca `https://bgp.he.net/net/200.220.176.0/20` .
9. Investigue um endereço ip, bloco de rede ou domínio no `https://shodan.io/` ou `https://search.censys.io/` ou `https://www.zoomeye.hk/`.
10. Busque por subdomínios do domínio em `https://dnsdumpster.com/`  ou `https://searchdns.netcraft.com/`.
### Coleta de Informações ativa 

#### Enumeração DNS

1. Descobrir o endereço ip do domínio com `host`. 
2. Descobrir subdomínios de um domínio após efetuar uma Transferência de Zona DNS utilizando `host -l -a dominio.com ns2.dominio.com`. 
3. Descobrir subdomínios de um domínio com Brute Force de DNS  utilizando wordlists de subdomínios.
5. Também é possível obter estes domínios através de um Scan DNS reverso do bloco de rede.
6.  Para automatizar parte deste processo utilize os ferramentas `dnsrecon` ou `dnsenum`.

#### Enumeração de Portas

1. Executar um Ping ou Arp Sweep, caso esteja na mesma subrede do alvo, escaneando quais são os hosts ativos.
2. Executar um scanner de rede do bloco de rede ou de hosts em específico mapeando  as portas TCP e UDP abertas ou filtradas, a versão dos serviços sendo executados, o sistema operacional dos hosts e possíveis vulnerabilidades. Para isso:
	- Primeiramente escaneie as portas mais frequentes da forma mais furtiva possível.
	- Em seguida escaneie pela versão das portas encontradas.
	- Em seguida escaneie por vulnerabilidades nestas portas.
	- Sempre use ProxyChains ou VPN para evitar ter seu IP bloqueado.

### Coleta de Informações da Web

1. Consultar informações disponíveis nos headers através do site `https://securityheaders.com/`. 
2. Consultar informações sobre a configuração SSL/TLS do servidor através do site `https://www.ssllabs.com/ssltest/`.
3. Procurar por informações sensíveis no `robot.txt`, `sitemap.xml` e `.git`.
4. Inspecionar os métodos HTTP permitidos fazendo uma requisição `OPTIONS` no Netcat.
5. Descobrir a versão da tecnologia sendo utilizada (PHP, ASP, JSP, etc.) analisando o header de arquivos com estas extensões.
6. Obter detalhes do servidor com `whatweb -v` ou com a extensão `wappalyzer`.
7. Inspecionar o código fonte por informações sensíveis presentes no código. Para isto pode ser útil baixar o mirror do site com `wget -m -e robots=off example.com`. 
	- Prestar bastante atenção nas meta tags nesta etapa pois podem expor dados do servidor, aplicação web ou framework utilizado.
8. Inspecionar o código fonte por diretórios e endpoints escondidos fazendo um scan por href.
9. Inspecionar erros lançados pelo servidor. Alguns exemplos de erros são:
	- visitar páginas não existentes; 
	- inserir dados inválidos; 
	- utilizar métodos HTTP inválidos;
	- simular uma falha de autenticação com credenciais inválidas;
	- simular um Bad Request.
10. Inspecionar por logs no console.
11. Inferir diretórios e endpoints usando a notação adotada pelos desenvolvedores.
12. Descobrir diretórios e endpoints escondidos com WFuzz ou Dirb.

## Vulnerabilidades

### DNS

1. Testar por email spoofing.
2. Testar por subdomain takeover.

## Vulnerabilidades Web
### Access Control Vulnerabilities

#### Vertical Escalation

1. Procurar por parâmetros (Request Parameters, Path Parameters, Cookies, Headers) que definem acesso a aplicação e tentar alterá-los.
2. Procurar por headers que definem acesso a aplicação utilizando o método HTTP TRACE.
3. Testar escapar a autenticação a diretórios e endpoints manipulando Headers de Requisição Especiais. [Mais Informações](/Web%20Hacking/Server%20Side%20Vulnerabilities/Access%20Control%20Vulnerabilities/Desvio%20de%20Autenticação%20Manipulando%20Headers%20de%20Requisições%20Especiais.md)
4. Testar escapar a autenticação a diretórios e endpoints trocando o método HTTP da requisição. [Mais Informações](/Web%20Hacking/Server%20Side%20Vulnerabilities/Access%20Control%20Vulnerabilities/Desvio%20de%20Autenticação%20Manipulando%20o%20Metódo%20HTTP.md)
5. Testar se discrepâncias na correspondências de URL conseguem desviar a autenticação. [Mais Informações](/Web%20Hacking/Server%20Side%20Vulnerabilities/Access%20Control%20Vulnerabilities/Discrepâncias%20de%20Correspondências%20de%20URL.md)
6. Testar se mudando o header referer para a origem do endpoint é possível escapar à autenticação.

#### Horizontal Escalation

1. Testar por vulnerabilidades de Insecure direct object reference (IDOR) adivinhando parâmetros que definam acesso a outros usuários.
2. Caso o parâmetro não seja adivinhável procurar por locais em que os parâmetros estejam expostos no código. 

### SQL Injection

1. Buscar por SQLi em logins através de payloads de bypass de autenticação. 

2. Buscar por SQLi em buscas. 

3. Caso a aplicação seja vulnerável tentar acessar outras tabelas com Union. [Mais Informações](/Web%20Hacking/Injections/SQLi/SQLI%20Union%20Attacks.md)

4. Caso a aplicação seja vulnerável tentar identificar informações sobre o banco de dados. [Mais Informações](/Web%20Hacking/Injections/SQLi/Identificando%20Informações%20sobre%20o%20Banco%20de%20Dados.md)

5. Testar por Blind SQLi através de respostas condicionais. [Mais Informações](/Web%20Hacking/Injections/SQLi/Blind%20SQLi%20através%20de%20Respostas%20Condicionais.md)

6. Testar por Blind SQLi de injeção baseada em Erro. [Mais Informações](/Web%20Hacking/Injections/SQLi/Blind%20SQLi%20através%20de%20Erros%20Condicionais.md)

7. Testar por Blind SQLi de injeção baseada em Tempo. [Mais Informações](/Web%20Hacking/Injections/SQLi/Blind%20SQLi%20através%20de%20Delays%20Condicionais.md)

8. Testar por consultas empilhadas.

9. Testar por injeção de comandos.

10. Buscar por SQLi em inserções.

```sql
INSERT INTO posts (title, body) VALUES ('Test', 'This is a test post'); UPDATE users set password='letmein' WHERE user='administrator' --
```

11. Buscar por SQLi em atualizações.

```sql
UPDATE users SET password = 'letmein' WHERE username = 'admin' --' WHERE username = 'victor'
```

12. Testar por second order sqli.