# Wapiti

## Introdução

Wapiti é uma ferramenta de código aberto usada para realizar varreduras de vulnerabilidades em aplicações web. Ele permite identificar várias vulnerabilidades, incluindo XSS, SQL Injection, Command Injection, e outras, através de fuzzing e análise de resposta de servidores web. 

## Instalação

### Instalação no Kali Linux

No Kali Linux, o Wapiti pode ser instalado usando:

```bash
sudo apt-get update
sudo apt-get install wapiti
```

### Instalação via pip

Se você estiver usando outra distribuição Linux, pode instalar Wapiti usando o pip:

```bash
sudo apt-get update
sudo apt-get install python3-pip
pip3 install wapiti3
```

## Conceitos Básicos

Wapiti funciona realizando varreduras em aplicações web para identificar potenciais vulnerabilidades. Ele envia vários tipos de payloads e analisa as respostas para determinar se a aplicação está vulnerável.

## Comandos Básicos

### Estrutura do Comando

A estrutura básica de um comando Wapiti é:

```bash
wapiti -u URL [opções]
```

### Parâmetros Comuns

#### -u

Define a URL alvo.

```bash
wapiti -u http://example.com/
```

#### -p

Especifica parâmetros para injeção.

```bash
wapiti -u http://example.com/ -p "id"
```

#### --scope

Define o escopo da varredura (page, folder, domain).

```bash
wapiti -u http://example.com/ --scope page
```

#### -m

Especifica os módulos a serem usados na varredura.

```bash
wapiti -u http://example.com/ -m sql,xss,backup
```

#### -l

Define o nível de profundidade da varredura.

```bash
wapiti -u http://example.com/ -l 2
```

#### -o

Especifica o arquivo de saída para salvar o relatório.

```bash
wapiti -u http://example.com/ -o /tmp/relatorio.html
```

#### --verify-ssl

Verifica certificados SSL.

```bash
wapiti -u https://example.com/ --verify-ssl false
```

### Uso de Proxy

Para usar Wapiti com um proxy:

```bash
wapiti -u http://example.com/ --proxy http://127.0.0.1:8080
```

### Autenticação HTTP

Para autenticação HTTP básica:

```bash
wapiti -u http://example.com/ --auth-basic "user:password"
```

### Customização de User-Agent

Para definir um User-Agent customizado:

```bash
wapiti -u http://example.com/ --user-agent "Mozilla/5.0"
```

## Módulos de Varredura

Wapiti possui vários módulos que podem ser usados para identificar diferentes tipos de vulnerabilidades. Alguns dos módulos mais comuns incluem:

### SQL Injection

```bash
wapiti -u http://example.com/ -m sql
```

### Cross-Site Scripting (XSS)

```bash
wapiti -u http://example.com/ -m xss
```

### File Handling (manipulação de arquivos)

```bash
wapiti -u http://example.com/ -m file
```

### Backup Files

```bash
wapiti -u http://example.com/ -m backup
```

### Command Injection

```bash
wapiti -u http://example.com/ -m shellshock
```

## Análise e Relatórios

### Tipos de Relatórios

Wapiti pode gerar relatórios em vários formatos, incluindo HTML, XML, JSON, e TXT. Especifique o formato desejado com a opção `-o`:

#### Relatório em HTML

```bash
wapiti -u http://example.com/ -o /tmp/relatorio.html
```

#### Relatório em JSON

```bash
wapiti -u http://example.com/ -o /tmp/relatorio.json
```