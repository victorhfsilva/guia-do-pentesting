# Censys

## Introdução

**Censys** é uma plataforma de pesquisa e análise de segurança voltada para a descoberta de ativos conectados à internet. Ele varre continuamente a internet e coleta informações sobre hosts, serviços, certificados SSL/TLS, e outras informações expostas. O Censys é amplamente utilizado por profissionais de segurança para realizar auditorias de segurança, monitorar a exposição de sistemas e identificar vulnerabilidades.

Uma das principais funcionalidades do Censys é sua busca avançada, que permite o uso de **filtros** para refinar os resultados e encontrar dispositivos específicos, serviços, ou vulnerabilidades. Este guia mostrará como usar os filtros do Censys para melhorar suas buscas e maximizar a eficiência nas pesquisas.

## Como Funciona a Busca no Censys?

O Censys oferece uma interface de busca poderosa, onde você pode usar filtros e operadores avançados para encontrar informações detalhadas sobre dispositivos e serviços conectados. Os filtros permitem especificar critérios como portas abertas, versões de software, geolocalização, tipos de certificados SSL e muito mais.

A busca do Censys é dividida em três categorias principais:

1. **IPv4 Hosts**: Dispositivos conectados diretamente à internet.
2. **Websites**: Sites e domínios.
3. **Certificados**: Certificados SSL/TLS.

## Operadores e Filtros no Censys

O Censys permite o uso de uma variedade de operadores para criar consultas detalhadas. Aqui estão os operadores básicos que você pode usar para refinar suas buscas:

### Principais Operadores do Censys

1. **AND**: Combina duas condições (retorna resultados que satisfaçam ambas).
   ```bash
   port:443 AND service:HTTP
   ```

2. **OR**: Retorna resultados que atendem a qualquer uma das condições especificadas.
   ```bash
   port:443 OR port:80
   ```

3. **NOT**: Exclui resultados que satisfaçam uma determinada condição.
   ```bash
   NOT port:22
   ```

4. **=**: Usa igualdade exata.
   ```bash
   location.country_code = "US"
   ```

5. **!=**: Usa desigualdade.
   ```bash
   location.country_code != "US"
   ```

6. **>**, **<**: Comparações maior que/menor que para valores numéricos.
   ```bash
   service.software.version > 1.0
   ```

## Filtros Comuns no Censys

Aqui estão os filtros mais comuns que você pode usar em suas pesquisas no Censys.

###  **Portas (Ports)**

Você pode usar o filtro de **portas** para encontrar dispositivos que estão escutando em uma determinada porta.

#### Exemplo de Filtro
Procurar dispositivos com a porta 80 (HTTP) aberta:
```bash
ports:80
```

Ou pesquisar dispositivos que estejam com portas 22 (SSH) e 443 (HTTPS) abertas simultaneamente:
```bash
ports:22 AND ports:443
```

###  **Serviço (Service)**

O filtro **service** é usado para identificar dispositivos que oferecem um serviço específico, como HTTP, SSH, RDP, entre outros.

#### Exemplo de Filtro
Procurar por dispositivos rodando servidores HTTP:
```bash
service:HTTP
```

Ou dispositivos com FTP habilitado:
```bash
service:FTP
```

### **Geolocalização (Location)**

Os filtros de **geolocalização** permitem restringir a busca a dispositivos localizados em países, cidades ou regiões específicas.

#### Exemplo de Filtro
Procurar dispositivos localizados nos Estados Unidos:
```bash
location.country_code = "US"
```

Procurar dispositivos em uma cidade específica, como São Paulo:
```bash
location.city = "São Paulo"
```

Ou pesquisar dispositivos em um determinado continente:
```bash
location.continent = "Europe"
```

### **Provedores de Internet (Autonomous System, AS)**

Este filtro permite buscar dispositivos de acordo com o AS (Autonomous System) ou provedores de internet.

#### Exemplo de Filtro
Procurar dispositivos no AS do Google:
```bash
autonomous_system.organization = "Google"
```

Ou pesquisar por um AS específico, como o AS15169 do Google:
```bash
autonomous_system.asn = 15169
```

### **Sistema Operacional (Operating System)**

O filtro de **sistema operacional** é útil para encontrar dispositivos rodando versões específicas de sistemas operacionais.

#### Exemplo de Filtro
Procurar por dispositivos rodando Windows:
```bash
operating_system:"Windows"
```

Ou buscar dispositivos que estejam executando Linux:
```bash
operating_system:"Linux"
```

### **Certificados SSL/TLS (Certificates)**

Os filtros de **certificados** são usados para encontrar certificados SSL/TLS que estão sendo usados em dispositivos conectados à internet.

#### Exemplo de Filtro
Procurar por dispositivos que utilizam certificados SSL emitidos pela Let's Encrypt:
```bash
443.https.tls.certificate.issuer.common_name: "Let's Encrypt"
```

Ou pesquisar por certificados com chaves públicas RSA:
```bash
443.https.tls.certificate.key_algorithm: "RSA"
```

### **Versão de Software**

Você pode usar o Censys para encontrar dispositivos rodando versões específicas de software.

#### Exemplo de Filtro
Procurar por servidores Apache rodando a versão 2.4:
```bash
service.software.name = "Apache" AND service.software.version = "2.4"
```

Ou buscar por dispositivos executando uma versão vulnerável do OpenSSH:
```bash
service.software.name = "OpenSSH" AND service.software.version < "7.6"
```

### **Certificados Expirados**

Este filtro é útil para encontrar dispositivos que estão usando certificados expirados, o que pode indicar uma configuração insegura.

#### Exemplo de Filtro
Procurar por certificados expirados:
```bash
443.https.tls.certificate.validity.end < NOW
```

Ou buscar certificados que expiram nos próximos 30 dias:
```bash
443.https.tls.certificate.validity.end:[NOW TO NOW+30DAYS]
```

### **Banner de Serviço**

Os **banners de serviço** contêm informações sobre o serviço que está sendo oferecido por um dispositivo. O Censys coleta esses banners durante suas varreduras.

#### Exemplo de Filtro
Procurar por dispositivos que exibem o nome "Apache" em seu banner de serviço:
```bash
service.banner: "Apache"
```

Ou buscar por banners que mencionem "Welcome to nginx":
```bash
service.banner: "Welcome to nginx"
```

## Exemplos de Consultas Avançadas no Censys

Aqui estão exemplos práticos de como combinar filtros para realizar buscas avançadas no Censys.

### Buscar por Servidores HTTP no Brasil

```bash
service:HTTP AND location.country_code = "BR"
```

Este filtro retorna servidores HTTP localizados no Brasil.

### Buscar por Dispositivos com SSH (porta 22) e Versões Antigas do OpenSSH

```bash
ports:22 AND service.software.name: "OpenSSH" AND service.software.version < "7.6"
```

Este comando retorna dispositivos rodando versões do OpenSSH anteriores à 7.6, que podem ser vulneráveis a ataques.

### Buscar Dispositivos com Certificados da Let's Encrypt em Londres

```bash
443.https.tls.certificate.issuer.common_name: "Let's Encrypt" AND location.city = "London"
```

Este filtro encontra dispositivos na cidade de Londres que utilizam certificados emitidos pela Let's Encrypt.

### Buscar por Dispositivos Rodando Windows com a Porta 3389 Aberta (RDP)

```bash
ports:3389 AND operating_system: "Windows"
```

Isso encontra dispositivos Windows com a porta 3389 (usada para RDP) aberta, o que pode representar uma vulnerabilidade se não for devidamente protegido.

### Buscar por Certificados Expirados no Canadá

```bash
443.https.tls.certificate.validity.end < NOW AND location.country_code = "CA"
```

Este filtro retorna dispositivos no Canadá que estão usando certificados SSL expirados.

### Buscar por Endereços IPs em determinado bloco de rede

```bash
ip:[37.59.174.224 TO 37.59.174.239]
```

Este filtro retorna domínios com endereços IPs dentro do intervalo.

### Buscar por Endereços IPs em determinado bloco de rede

```bash
ip:[37.59.174.224 TO 37.59.174.239]
```

Este filtro retorna domínios com endereços IPs dentro do intervalo.
