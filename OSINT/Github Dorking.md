# GitHub Dorking

## Introdução

**GitHub Dorking** é uma técnica usada para encontrar informações sensíveis em repositórios públicos do GitHub. Muitos desenvolvedores acabam cometendo erros, como publicar credenciais de acesso, chaves de API, segredos de configuração, ou informações sensíveis por acidente. Com o GitHub Dorking, é possível usar operadores de busca avançada para localizar esses tipos de informações. Essa técnica pode ser útil tanto para auditores de segurança quanto para cibercriminosos, por isso é importante saber como proteger-se e entender as vulnerabilidades.

## Funcionamento do GitHub Dorking

O GitHub possui uma poderosa funcionalidade de busca que permite procurar por código, repositórios, e commits. Ao utilizar operadores de busca avançada, é possível filtrar e refinar os resultados de busca para encontrar arquivos ou trechos de código específicos.

### Operadores de Busca no GitHub

- **in:** Especifica onde procurar (ex.: código, nome do repositório, etc.).
- **repo:** Limita a busca a um repositório específico.
- **extension:** Limita a busca a arquivos com uma extensão específica.
- **path:** Limita a busca a um caminho de arquivo específico.
- **language:** Limita a busca a uma linguagem de programação específica.
- **user:** Limita a busca a um usuário ou organização específica.
- **filename:** Procura por arquivos com nomes específicos.

### Exemplos de Operadores de Busca

- `in:code`: Procura dentro do código.
- `in:file`: Procura dentro de arquivos.
- `in:readme`: Procura dentro dos arquivos `README.md`.
- `repo:<nome_do_repositório>`: Procura dentro de um repositório específico.
- `user:<nome_do_usuário>`: Procura por um usuário específico.
- `language:<linguagem>`: Limita a busca a uma linguagem específica, como `Python`, `JavaScript`, etc.
- `filename:<nome_arquivo>`: Busca por arquivos com um nome específico.

## Exemplos Comuns de GitHub Dorking

Aqui estão alguns exemplos de dorks do GitHub que podem ser usados para encontrar dados sensíveis.

### Procurar por Credenciais de AWS

Chaves de acesso da AWS podem ser acidentalmente expostas em repositórios públicos. Para localizar esse tipo de chave:

```bash
"aws_access_key_id" "aws_secret_access_key" language:plaintext
```

Isso buscará por variáveis de ambiente ou arquivos de configuração onde credenciais AWS possam ter sido expostas.

### Procurar por Chaves de API

As chaves de API são outro tipo comum de credencial que pode ser exposta em repositórios:

```bash
"api_key" language:python
```

Aqui estamos buscando por chaves de API em código escrito em Python.

### Procurar por Arquivos de Configuração

Muitas vezes, arquivos de configuração com credenciais são incluídos inadvertidamente nos repositórios. Um exemplo é o arquivo `.env`, que contém variáveis de ambiente e credenciais:

```bash
filename:.env
```

Este dork buscará por arquivos `.env` públicos no GitHub.

### Procurar por Senhas

Senhas codificadas ou expostas em arquivos podem ser buscadas com:

```bash
"password" language:javascript
```

Aqui estamos buscando por instâncias da palavra "password" em código escrito em JavaScript.

### Procurar por Token de Acesso ao Slack

```bash
"slack_token" language:json
```

Isso buscará por tokens de integração do Slack, frequentemente armazenados em arquivos JSON.

### Buscar por Credenciais MySQL

```bash
"mysql_connect" "password" language:php
```

Essa query buscará por credenciais MySQL que podem estar hardcoded em código PHP.

### Procurar por Arquivos SSH

Certas chaves SSH podem ser inadvertidamente expostas em repositórios públicos:

```bash
filename:id_rsa
```

Esse dork buscará por arquivos de chaves privadas SSH (`id_rsa`), que não devem ser tornados públicos.

### Procurar por Informações Sensíveis em Commits

Às vezes, as credenciais são expostas em commits anteriores, mesmo que tenham sido removidas das versões mais recentes dos arquivos:

```bash
"password" path:config
```

Esse dork busca por instâncias da palavra "password" dentro de diretórios de configuração, que podem estar em versões anteriores.

### Buscar por Tokens de Firebase

```bash
"FIREBASE_API_KEY" language:javascript
```

Esse dork é útil para encontrar tokens de autenticação do Firebase expostos acidentalmente.

### Procurar por Tokens de Discord

```bash
"discord_token" language:javascript
```

Isso busca por tokens de bots ou integrações do Discord que possam estar públicos em repositórios.

## Protegendo-se de GitHub Dorking

Agora que você entende o quão fácil pode ser encontrar informações sensíveis no GitHub, é fundamental saber como proteger-se para evitar que dados confidenciais sejam expostos.

### Usar um Arquivo `.gitignore`

O arquivo `.gitignore` define quais arquivos não devem ser incluídos no repositório. Para garantir que arquivos de configuração sensíveis (como `.env`, `config.yml`, etc.) não sejam comitados, adicione-os ao `.gitignore`.

Exemplo de `.gitignore`:

```bash
# Ignorar arquivos de configuração sensíveis
.env
config.yml
keys/
```

### Revise Commits Antes de Puxá-los

Antes de fazer commits no GitHub, sempre revise cuidadosamente as mudanças para garantir que nenhuma credencial ou informação sensível tenha sido adicionada ao código.

Você pode ver a lista de alterações prontas para serem comitadas com:

```bash
git status
```

E verificar as mudanças detalhadas com:

```bash
git diff
```

### Revogação de Chaves Expostas

Se você perceber que uma chave de API ou credencial foi acidentalmente publicada, certifique-se de **revogá-la** imediatamente e substituí-la por uma nova. Muitas APIs fornecem ferramentas para rotação de chaves.

### Usar GitHub Secrets para Armazenar Credenciais

Para repositórios públicos ou privados que precisam de acesso a credenciais, o GitHub oferece a funcionalidade de **GitHub Secrets**, que permite armazenar chaves e variáveis de ambiente de forma segura. Isso pode ser configurado no menu "Settings" do repositório.

### Ferramentas de Monitoramento e Alerta

Existem ferramentas automatizadas que podem ajudar a detectar e alertar sobre credenciais expostas no GitHub. Algumas das mais populares são:

- **GitGuardian**: Monitora e detecta credenciais sensíveis expostas em repositórios GitHub.
- **truffleHog**: Ferramenta open source para escanear commits de repositórios Git e detectar chaves e credenciais.
- **Gitleaks**: Outra ferramenta open source que verifica repositórios em busca de informações sensíveis.

### Uso de Variáveis de Ambiente

Em vez de hardcodar credenciais e chaves no código-fonte, use variáveis de ambiente para armazenar informações sensíveis. Isso permite que o código permaneça seguro enquanto as credenciais são mantidas fora do repositório.
