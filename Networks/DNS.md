# Protocolo DNS (Domain Name System)

## Introdução ao DNS

O **Domain Name System (DNS)** é um protocolo essencial para o funcionamento da Internet, responsável por traduzir nomes de domínio legíveis por humanos (como `www.exemplo.com`) em endereços IP legíveis por máquinas (como `192.0.2.1`). O DNS funciona como uma espécie de "agenda telefônica" da internet, permitindo que os usuários acessem sites e serviços usando nomes amigáveis em vez de números IP difíceis de memorizar.

## Estrutura e Funcionamento do DNS

### Componentes Principais do DNS

- **Domínios e Subdomínios**: Um domínio é um nome legível por humanos que é associado a um endereço IP. Por exemplo, `exemplo.com` é um domínio, e `www.exemplo.com` é um subdomínio.
- **Zonas**: Uma zona DNS é uma parte de um domínio que é administrada por uma entidade específica. A zona contém registros DNS que associam nomes de domínio a endereços IP.
- **Servidores DNS**: São servidores que armazenam os registros DNS e respondem às consultas DNS. Existem vários tipos de servidores DNS:
  - **Servidores Raiz**: O ponto mais alto da hierarquia DNS, responsáveis por encaminhar as consultas para os servidores de domínios de nível superior (TLD).
  - **Servidores TLD (Top-Level Domain)**: Servem para domínios de primeiro nível como `.com`, `.org`, `.net`, e assim por diante.
  - **Servidores Autoritativos**: Contêm a informação DNS definitiva sobre um domínio específico e respondem às consultas sobre esse domínio.
  - **Servidores Recursivos**: Recebem consultas DNS dos clientes e as encaminham por toda a hierarquia DNS para obter a resposta correta.

### Resolução de Nomes DNS

O processo de resolução de nomes DNS envolve várias etapas:

1. **Consulta do Cliente**: Um usuário digita um nome de domínio no navegador, e o sistema operacional envia uma consulta DNS ao servidor DNS configurado (geralmente um servidor recursivo).
2. **Consulta Recursiva**: O servidor DNS recursivo consulta outros servidores DNS para resolver o nome de domínio. Ele começa com os servidores raiz, que redirecionam a consulta para os servidores TLD, que por sua vez redirecionam para os servidores autoritativos do domínio.
3. **Resposta**: O servidor autoritativo do domínio responde com o endereço IP correspondente ao nome de domínio. Essa resposta é enviada de volta ao servidor recursivo, que a repassa ao cliente.
4. **Cache**: Para melhorar a eficiência, o servidor recursivo pode armazenar (ou "cachear") a resposta por um período, reduzindo o tempo necessário para responder a consultas futuras sobre o mesmo nome de domínio.

## Tipos de Consultas DNS

- **Consulta Recursiva**: O cliente espera uma resposta completa, e o servidor recursivo faz todo o trabalho de resolver o nome de domínio.
- **Consulta Iterativa**: O servidor DNS responde com a melhor resposta possível, que pode ser uma referência a outro servidor DNS, ao qual o cliente pode consultar diretamente.
- **Consulta Inversa (Reverse DNS Lookup)**: Em vez de resolver um nome de domínio para um endereço IP, uma consulta inversa resolve um endereço IP para um nome de domínio.

## Registros DNS Comuns

Os registros DNS são entradas que mapeiam nomes de domínio para diferentes tipos de informações. Alguns dos registros DNS mais comuns incluem:

- **A (Address Record)**: Mapeia um nome de domínio para um endereço IPv4.
- **AAAA (IPv6 Address Record)**: Mapeia um nome de domínio para um endereço IPv6.
- **CNAME (Canonical Name Record)**: Mapeia um nome de domínio para outro nome de domínio (um alias).
- **MX (Mail Exchange Record)**: Define os servidores de e-mail responsáveis por receber e-mails para o domínio.
- **NS (Name Server Record)**: Especifica os servidores DNS autoritativos para o domínio.
- **PTR (Pointer Record)**: Usado para consultas inversas, mapeando um endereço IP para um nome de domínio.
- **TXT (Text Record)**: Armazena texto arbitrário, frequentemente usado para verificação de domínio e autenticação de e-mail (por exemplo, registros SPF, DKIM).
- **SRV (Service Record)**: Especifica serviços disponíveis sob o domínio, como servidores SIP ou LDAP.

## Segurança no DNS

### DNS Spoofing e Cache Poisoning

- **Definição**: DNS Spoofing, ou Cache Poisoning, ocorre quando um invasor envia respostas DNS falsas para o servidor recursivo, fazendo com que ele armazene informações incorretas. Isso pode levar os usuários a sites maliciosos.
- **Mitigação**: Usar DNSSEC (DNS Security Extensions) pode ajudar a proteger contra esses ataques, adicionando assinaturas criptográficas aos dados DNS.

### DNSSEC (DNS Security Extensions)

- **Definição**: DNSSEC é um conjunto de extensões ao protocolo DNS que permite que as respostas DNS sejam assinadas criptograficamente, garantindo sua autenticidade e integridade.
- **Funcionamento**: Quando um servidor DNS responde a uma consulta, ele inclui uma assinatura digital que pode ser verificada pelo cliente ou pelo servidor recursivo para garantir que a resposta não foi alterada.

### DNS over HTTPS (DoH) e DNS over TLS (DoT)

- **Definição**: DoH e DoT são protocolos que criptografam as consultas DNS, impedindo que elas sejam interceptadas ou modificadas por intermediários.
- **Uso**: Ambos os protocolos são usados para proteger a privacidade do usuário, garantindo que as consultas DNS não possam ser monitoradas ou alteradas por terceiros.

### Ferramentas

- **nslookup**: Ferramenta de linha de comando que consulta servidores DNS e exibe as informações de resolução de nomes.
- **dig**: Outra ferramenta de linha de comando para consultas DNS avançadas, usada para investigar e solucionar problemas relacionados ao DNS.
- **host**: Simples e útil para realizar consultas DNS e obter informações sobre o domínio.

