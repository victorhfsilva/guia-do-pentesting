# **Masscan**

## Introdução

**Masscan** é uma das ferramentas de varredura de portas mais rápidas e eficientes disponíveis, conhecida por sua capacidade de escanear a internet inteira em poucos minutos. Desenvolvido para alcançar velocidades impressionantes, o Masscan é amplamente utilizado por pentesters, administradores de rede e profissionais de segurança para realizar auditorias de segurança e detectar serviços expostos.

Masscan opera de maneira semelhante ao Nmap, mas com um motor de escaneamento otimizado para desempenho. Ele utiliza pacotes de rede personalizados e técnicas avançadas para enviar e receber milhões de pacotes por segundo, permitindo uma varredura extremamente rápida de grandes blocos de endereços IP. No entanto, devido à sua alta taxa de pacotes, é essencial utilizá-lo com responsabilidade, especialmente em redes públicas.

## Características do Masscan

- **Escaneamento Super Rápido**: Capaz de escanear toda a internet em minutos, graças a seu mecanismo de envio de pacotes altamente otimizado.
- **Customização de Pacotes**: Permite personalizar pacotes TCP, UDP, ICMP, entre outros, para realizar varreduras específicas.
- **Baixo Uso de Recursos**: Desenvolvido para eficiência, Masscan pode escanear grandes redes com uso mínimo de recursos do sistema.
- **Detecção de Serviços e Vulnerabilidades**: Escaneia portas e serviços específicos, ajudando a identificar portas abertas e serviços potencialmente vulneráveis.

## Uso Básico do Masscan

O Masscan é altamente configurável, mas sua sintaxe básica segue um padrão simples: você especifica o alvo (`-p` para portas, `-p` para protocolos) e define parâmetros de desempenho, como a taxa de pacotes.

### Escaneamento Básico de Portas

Para escanear portas específicas de um endereço IP, utilize o seguinte comando:

```bash
masscan -p80,443 192.168.1.0/24
```

**Explicação:**

- **`-p80,443`**: Especifica as portas HTTP (80) e HTTPS (443) para escanear.
- **`192.168.1.0/24`**: Define o intervalo de IPs a ser escaneado (sub-rede local).

### Ajustando a Taxa de Pacotes

O Masscan pode enviar pacotes muito rapidamente, mas em redes internas ou para evitar sobrecarga de dispositivos, você pode ajustar a taxa de pacotes usando `--rate`:

```bash
masscan -p22,80,443 192.168.1.0/24 --rate=1000
```

**Explicação:**

- **`--rate=1000`**: Limita a taxa de envio para 1000 pacotes por segundo.

### Escaneando a Internet Inteira

Masscan pode ser utilizado para escanear a internet inteira. **Atenção:** Este tipo de varredura deve ser realizado apenas com permissão explícita e entendimento das consequências legais.

```bash
masscan 0.0.0.0/0 -p80 --rate=100000
```

**Explicação:**

- **`0.0.0.0/0`**: Representa toda a internet.
- **`-p80`**: Escaneia a porta 80.
- **`--rate=100000`**: Envia 100.000 pacotes por segundo.

### Salvando Resultados em Arquivo

Os resultados do Masscan podem ser exportados para um arquivo para análise posterior:

```bash
masscan -p80,443 192.168.1.0/24 -oX resultados.xml
```

**Explicação:**

- **`-oX resultados.xml`**: Salva os resultados no formato XML, compatível com o Nmap.

## Parâmetros Adicionais Úteis do Masscan

- **`--banners`**: Coleta banners dos serviços encontrados, útil para detectar versões de software.
- **`--source-ip`**: Define o IP de origem dos pacotes enviados, útil para redes com NAT ou roteamento especial.
- **`--interface`**: Especifica a interface de rede a ser usada durante o escaneamento.
- **`--retries`**: Define o número de tentativas para enviar pacotes novamente para o mesmo alvo.

### Exemplo Completo:

```bash
masscan -p22,80,443 192.168.1.0/24 --rate=500 --banners --retries=3
```

Este comando escaneia as portas 22, 80 e 443, coleta banners de serviços e faz três tentativas para cada pacote que falhar.

## Boas Práticas e Dicas de Uso

1. **Use em Redes Autorizadas**: Devido à sua velocidade, o Masscan pode facilmente sobrecarregar redes e dispositivos. Use-o apenas em redes onde você tem permissão explícita.
   
2. **Ajuste a Taxa de Pacotes**: Ajuste a taxa de pacotes para evitar congestionar a rede ou atrair alertas de segurança.

4. **Monitore o Tráfego**: Ao usar o Masscan em ambientes de produção, monitore o tráfego para identificar impactos negativos e ajustar parâmetros.

5. **Entenda as Consequências Legais**: Escanear redes públicas pode ser considerado ilegal sem permissão. Sempre entenda as leis locais e busque autorização.
