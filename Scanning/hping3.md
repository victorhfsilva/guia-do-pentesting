# **hping3**

## Introdução

**hping3** é uma ferramenta de linha de comando poderosa e versátil utilizada para testes de redes, auditorias de segurança, e diagnóstico de conectividade. Originalmente projetada para enviar pacotes TCP de forma personalizada, o hping3 evoluiu para suportar a criação e envio de pacotes TCP, UDP, ICMP, e RAW-IP, permitindo simular diversos tipos de tráfego de rede.

Diferente de ferramentas como o ping, que apenas envia pacotes ICMP, o hping3 permite a criação de pacotes complexos, controle detalhado sobre cabeçalhos, e a execução de ataques simulados, como SYN floods, testes de firewall, e mapeamento de portas. É amplamente utilizado por administradores de rede, profissionais de segurança, e pentesters para análise de rede, detecção de vulnerabilidades e testes de intrusão.

## Características do hping3

- **Envio de Pacotes Customizados**: Permite o envio de pacotes TCP, UDP, ICMP e RAW-IP com configurações personalizadas.
- **Simulação de Ataques**: Simula ataques de negação de serviço (DoS), SYN floods, e outros tipos de ataques para testar defesas de rede.
- **Testes de Firewall**: Identifica quais portas estão abertas ou filtradas por firewalls.
- **Detecção de Sistemas Operacionais**: Análise de respostas para deduzir o sistema operacional do host de destino.
- **Análise de Conectividade**: Testa rotas, latência e comportamento de redes em diferentes condições.

## Instalação do hping3

O **hping3** está disponível para a maioria das distribuições Linux e pode ser instalado facilmente usando o gerenciador de pacotes do sistema. Abaixo estão as instruções de instalação para Debian/Ubuntu, CentOS/RHEL, e macOS.

### Instalação no Debian/Ubuntu

Antes de instalar o hping3, certifique-se de que seu sistema está atualizado:

```bash
sudo apt-get update
```

Instale o hping3 com o comando:

```bash
sudo apt-get install hping3
```

### Instalação no CentOS/RHEL

Para CentOS e RHEL, você pode instalar o hping3 utilizando o EPEL (Extra Packages for Enterprise Linux):

```bash
sudo yum install epel-release
sudo yum install hping3
```

### Instalação no macOS

No macOS, você pode instalar o hping3 usando o Homebrew:

```bash
brew install hping
```

### Verificação da Instalação

Após a instalação, verifique se o hping3 foi instalado corretamente executando:

```bash
hping3 --version
```

Isso deve mostrar a versão do hping3 instalada no sistema.

## Uso Básico do hping3

O hping3 pode ser usado para uma ampla variedade de testes e análises. A sintaxe básica é:

```bash
hping3 <destino> [opções]
```

### Exemplo de Uso

Um exemplo básico para enviar pacotes ICMP (similar ao ping):

```bash
hping3 -1 8.8.8.8
```

Esse comando envia pacotes ICMP para o endereço IP `8.8.8.8`, que é o servidor DNS do Google.

### Exemplo de Saída:

```plaintext
HPING 8.8.8.8 (eth0 8.8.8.8): icmp mode set, 28 headers + 0 data bytes
len=46 ip=8.8.8.8 ttl=116 id=10416 icmp_seq=0 rtt=10.3 ms
len=46 ip=8.8.8.8 ttl=116 id=10417 icmp_seq=1 rtt=10.1 ms
```

- **icmp mode set**: Indica que o hping3 está enviando pacotes ICMP.
- **rtt**: Mostra o tempo de resposta (round-trip time) para cada pacote enviado.

## Principais Opções e Comandos do hping3

O hping3 oferece diversas opções que permitem ajustar os testes para simular diferentes cenários e análises de rede:

### Enviar Pacotes TCP (`-S`, `-A`, `-F`, `-R`)

O hping3 permite enviar pacotes TCP com diferentes flags, como SYN, ACK, FIN, RST, entre outros, para testar portas, firewalls e respostas de sistemas.

- **SYN Scan** (`-S`): Envia pacotes TCP SYN para verificar se uma porta está aberta.

  ```bash
  hping3 -S -p 80 192.168.1.1
  ```

  Esse comando envia pacotes SYN para a porta 80 do IP `192.168.1.1` para verificar se está aberta.

- **ACK Scan** (`-A`): Testa se uma porta é filtrada por um firewall.

  ```bash
  hping3 -A -p 80 192.168.1.1
  ```

### Enviar Pacotes UDP (`-2`)

Para enviar pacotes UDP, use a opção `-2`. Isso é útil para testar portas UDP abertas ou filtradas.

```bash
hping3 -2 -p 53 192.168.1.1
```

Esse comando envia pacotes UDP para a porta 53 (DNS) no endereço `192.168.1.1`.

### **Envio de Pacotes ICMP (`--icmp`)**

O parâmetro `--icmp` configura o hping3 para enviar pacotes ICMP, semelhantes aos utilizados pelo comando `ping`. Esse tipo de pacote é frequentemente usado para testes de conectividade e diagnósticos de rede, como medir latência (tempo de resposta) entre o host de origem e o destino.

- **Uso Comum**: Enviar pacotes ICMP para verificar se um host está ativo e medindo o RTT (round-trip time).

**Exemplo de Uso:**

```bash
hping3 --icmp 8.8.8.8
```

Esse comando envia pacotes ICMP para o endereço IP `8.8.8.8` (servidor DNS do Google), funcionando de forma similar ao comando `ping`.

#### **Configurando o Tipo de Código ICMP**

O parâmetro `-C` é utilizado para definir o tipo de código ICMP a ser enviado. O ICMP possui diferentes tipos de mensagens (ex.: Echo Request, Destination Unreachable), cada uma usada para um propósito específico. Por exemplo, o tipo 8 é usado para Echo Request (ping), enquanto o tipo 0 é para Echo Reply.

- **Uso Comum**: Configurar o tipo de mensagem ICMP para testar respostas específicas do destino, útil para testes de diagnóstico e auditorias.

**Exemplo de Uso:**

```bash
hping3 --icmp -C 8 8.8.8.8
```

Esse comando envia pacotes ICMP do tipo 8 (Echo Request) para o IP `8.8.8.8`, similar a um comando de ping.

#### **Configurando o Código de Erro ICMP**

O parâmetro `-K` define o código de erro específico para a mensagem ICMP que está sendo enviada. Diferentes tipos de mensagens ICMP podem ter códigos específicos que detalham a condição da mensagem, como códigos para pacotes fragmentados ou rotas não alcançáveis.

- **Uso Comum**: Testar como o destino responde a pacotes ICMP com códigos de erro específicos, útil para diagnósticos avançados de rede e simulação de condições de erro.

**Exemplo de Uso:**

```bash
hping3 --icmp -C 3 -K 1 8.8.8.8
```

Esse comando envia pacotes ICMP com o tipo 3 (Destination Unreachable) e código 1 (Host Unreachable) para `8.8.8.8`, simulando uma situação em que o host de destino é inatingível.

### Flood de Pacotes (`--flood`)

O modo flood é usado para enviar pacotes em alta velocidade, simulando um ataque de negação de serviço (DoS).

```bash
hping3 -S --flood -p 80 192.168.1.1
```

Esse comando envia um grande volume de pacotes SYN para a porta 80 de `192.168.1.1`, simulando um ataque SYN flood.

### Alterar o Tamanho dos Pacotes (`-d`)

A opção `-d` permite definir o tamanho do pacote em bytes, ajustando para simular diferentes tipos de carga de dados.

```bash
hping3 -S -p 80 -d 120 192.168.1.1
```

Esse comando envia pacotes SYN com 120 bytes de dados para a porta 80.

### **Contador de Pacotes (-c)** 

O parâmetro `-c` define o número de pacotes que o hping3 enviará para o destino antes de encerrar a execução. Sem esta opção, o hping3 continuará a enviar pacotes indefinidamente até que seja interrompido manualmente.

- **Uso Comum**: Limitar o número de pacotes enviados em um teste, especialmente útil para evitar sobrecarga acidental de redes ou dispositivos.

**Exemplo de Uso:**

```bash
hping3 -c 5 --icmp 8.8.8.8
```

Esse comando envia 5 pacotes ICMP para `8.8.8.8` e, em seguida, encerra a execução.

### Spoofing de IP (`-a`)

O hping3 pode falsificar o endereço IP de origem, útil para testar regras de firewall e verificar respostas a pacotes com IPs forjados.

```bash
hping3 -S -a 10.0.0.1 -p 80 192.168.1.1
```

Isso envia pacotes SYN para `192.168.1.1` aparentando vir do IP `10.0.0.1`.

### Ajustar TTL (`-t`)

Ajusta o TTL (Time to Live) dos pacotes, útil para testar roteamento e mapeamento de rede.

```bash
hping3 -S -t 64 -p 80 192.168.1.1
```

Esse comando envia pacotes SYN com TTL de 64.

### Modo Traceroute (`--traceroute`)

O hping3 pode executar um traceroute customizado para descobrir o caminho dos pacotes até o destino.

```bash
hping3 --traceroute -S -p 80 192.168.1.1
```

Esse comando realiza um traceroute para `192.168.1.1` usando pacotes SYN.

## Aplicações Práticas do hping3

### Testes de Firewall e Filtragem

O hping3 é frequentemente usado para verificar se portas estão abertas, filtradas ou fechadas, ajudando a avaliar as configurações de firewall.

```bash
hping3 -S -p 80 192.168.1.1
```

Esse comando verifica se a porta 80 está aberta no IP especificado.

### Teste de Resiliência a Ataques DoS

Simulando ataques como SYN flood, o hping3 ajuda a avaliar a resiliência de servidores contra ataques de negação de serviço.

```bash
hping3 -S --flood -p 80 192.168.1.1
```

Isso testa a capacidade do servidor de resistir a um ataque SYN flood.

### Detecção de Sistemas Operacionais

O hping3 pode enviar pacotes com características específicas para identificar o sistema operacional do destino com base nas respostas recebidas.

```bash
hping3 -S -p 80 --tcp-timestamp 192.168.1.1
```

Isso verifica os timestamps TCP para inferir o sistema operacional.

### Análise de Latência e Roteamento

Usando pacotes ICMP ou TCP, o hping3 pode medir latências e analisar rotas de rede, ajudando na otimização e diagnóstico de desempenho.

```bash
hping3 -1 8.8.8.8
```

Isso mede o tempo de resposta para o servidor DNS do Google.

## Considerações de Uso e Boas Práticas

1. **Uso Responsável**: O hping3 é uma ferramenta poderosa que pode causar impacto significativo em redes e sistemas. Use-o apenas com permissão explícita em ambientes controlados ou de teste.

2. **Simulação de Ataques**: Ao simular ataques, sempre use redes de teste e jamais execute em redes públicas ou sem autorização.

3. **Integração com Ferramentas de Análise**: Combine o hping3 com ferramentas como Wireshark para capturar e analisar pacotes detalhadamente.

4. **Monitoramento de Logs**: Ao realizar testes, monitore os logs de firewall e sistemas para entender as respostas e ajustar configurações conforme necessário.

5. **Automatização de Testes**: Considere automatizar testes recorrentes com scripts que utilizem hping3 para monitoramento contínuo e auditoria de segurança.






