# **arp-scan**

## Introdução

**arp-scan** é uma ferramenta de linha de comando usada para descobrir e identificar dispositivos ativos em uma rede local, utilizando pacotes ARP (Address Resolution Protocol). Diferente de outras ferramentas de varredura, como o Nmap, o arp-scan opera na camada de enlace (camada 2) da pilha OSI, o que o torna extremamente eficiente para descobrir hosts em redes locais, incluindo aqueles que bloqueiam pacotes ICMP.

O **arp-scan** é amplamente utilizado por administradores de rede, profissionais de segurança e pentesters para mapeamento de redes, detecção de dispositivos desconhecidos, identificação de endereços MAC e verificação de conflitos de IP. Sua simplicidade e eficácia fazem dele uma ferramenta essencial para tarefas de reconhecimento e auditoria de redes.

## Características do arp-scan

- **Descoberta Rápida de Hosts**: Escaneia rapidamente todos os dispositivos conectados a uma rede local.
- **Identificação de Endereços MAC**: Detecta o endereço MAC de dispositivos, útil para identificar fabricantes e tipos de dispositivos.
- **Varredura em Camada 2**: Utiliza pacotes ARP, tornando-o eficaz mesmo em redes onde pacotes ICMP estão bloqueados.
- **Customização de Saída**: Oferece opções para formatar a saída, facilitando a integração com scripts de automação.
- **Detecta Conflitos de IP**: Identifica quando múltiplos dispositivos estão usando o mesmo endereço IP.

## Instalação do arp-scan

O **arp-scan** está disponível na maioria das distribuições Linux e pode ser instalado facilmente através do gerenciador de pacotes do sistema. Abaixo estão as instruções de instalação para diferentes sistemas operacionais.

### Instalação no Debian/Ubuntu

```bash
sudo apt-get update
sudo apt-get install arp-scan
```

### Instalação no CentOS/RHEL

Para instalar no CentOS ou RHEL, você precisará do EPEL (Extra Packages for Enterprise Linux):

```bash
sudo yum install epel-release
sudo yum install arp-scan
```

### Instalação no Arch Linux

```bash
sudo pacman -S arp-scan
```

### Instalação no macOS

Para instalar o arp-scan no macOS, use o Homebrew:

```bash
brew install arp-scan
```

### Verificação da Instalação

Após a instalação, verifique se o arp-scan foi instalado corretamente executando:

```bash
arp-scan --version
```

Isso deve exibir a versão do arp-scan instalada no sistema.

## Uso Básico do arp-scan

A sintaxe básica do arp-scan é:

```bash
sudo arp-scan <opções> <intervalo de IP>
```

### Exemplo de Uso

```bash
sudo arp-scan --interface=eth0 192.168.1.0/24
```

Esse comando varre a rede `192.168.1.0/24` usando a interface de rede `eth0`, listando todos os dispositivos que respondem a pacotes ARP.

### Exemplo de Saída:

```plaintext
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.9.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)

192.168.1.1    00:1a:2b:3c:4d:5e    VendorName Inc.
192.168.1.2    00:2b:3c:4d:5e:6f    AnotherVendor Corp.
192.168.1.100  00:3c:4d:5e:6f:7g    SomeOtherVendor Ltd.

3 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.9.6: 256 hosts scanned in 2.001 seconds (127.93 hosts/sec). 3 responded
```

- **IP Address**: Mostra o endereço IP do dispositivo.
- **MAC Address**: Mostra o endereço MAC do dispositivo.
- **Vendor**: Identifica o fabricante do dispositivo com base no endereço MAC.

## Principais Opções e Parâmetros do arp-scan

O **arp-scan** oferece várias opções que permitem ajustar a varredura de acordo com suas necessidades:

### Especificar a Interface de Rede (`--interface` ou `-I`)

Por padrão, o arp-scan tenta usar a interface de rede padrão do sistema. Você pode especificar uma interface de rede específica com a opção `--interface` ou `-I`:

```bash
sudo arp-scan --interface=eth0 192.168.1.0/24
```

Isso força o arp-scan a usar a interface `eth0` para enviar pacotes ARP.

### Varredura de um Intervalo de IPs

Você pode especificar o intervalo de IPs a ser escaneado diretamente no comando:

```bash
sudo arp-scan 192.168.1.0/24
```

Isso varre toda a sub-rede `192.168.1.0/24`.

### Ignorar Dispositivos Específicos (`--ignore`)

Para ignorar um ou mais dispositivos na varredura, você pode usar a opção `--ignore` com o endereço MAC:

```bash
sudo arp-scan --ignore 00:1a:2b:3c:4d:5e 192.168.1.0/24
```

### Definir o Número de Pacotes ARP Enviados por Host (`--retry`)

Você pode definir quantas vezes o arp-scan deve tentar enviar pacotes ARP para cada host com a opção `--retry`:

```bash
sudo arp-scan --retry=2 192.168.1.0/24
```

Isso fará com que o arp-scan envie pacotes ARP duas vezes para cada host.

### Exibir Apenas Dispositivos que Respondem (`--responders-only`)

Para exibir apenas os dispositivos que respondem aos pacotes ARP, use a opção `--responders-only`:

```bash
sudo arp-scan --responders-only 192.168.1.0/24
```

### Especificar o Timeout (`--timeout`)

A opção `--timeout` permite definir o tempo de espera por respostas de dispositivos:

```bash
sudo arp-scan --timeout=100ms 192.168.1.0/24
```

Isso define um tempo de espera de 100 milissegundos por resposta.

### Salvar Resultados em um Arquivo (`--output`)

Você pode salvar os resultados da varredura em um arquivo para análise posterior:

```bash
sudo arp-scan 192.168.1.0/24 --output=resultados.txt
```

## Considerações de Uso e Boas Práticas

1. **Use com Permissão**: Sempre use o arp-scan com permissão do administrador da rede, especialmente em redes que você não possui. Escaneamentos não autorizados podem ser detectados como atividades maliciosas.

2. **Ajuste de Timeouts e Retries**: Ajuste os parâmetros de timeout e número de tentativas para balancear a precisão da varredura com o impacto na rede.

3. **Integração com Outras Ferramentas**: Combine o arp-scan com outras ferramentas, como Wireshark, para obter uma visão mais detalhada dos dispositivos na rede.

4. **Automatize para Monitoramento Contínuo**: Use o arp-scan em scripts para monitorar continuamente a presença de dispositivos na rede, detectando rapidamente mudanças.

5. **Evite Varreduras Frequentes**: Varreduras muito frequentes podem sobrecarregar a rede, especialmente em grandes ambientes. Use intervalos razoáveis entre as varreduras.