# Analisando Logs Suspeitos

- Antes de tudo a localização deste arquivo é `/var/log/apache2/access.log`.

- Uma das formas de buscar por todos os IPs que acessaram o servidor e a quantidade de acessos por IP é através do comando:

```bash
cat /var/log/apache2/access.log | cut -d " " -f1 | uniq -c | sort -unr
```

- Geralmente os IPs que executam o maior número de requisições é o IP suspeito. Descoberto qual é este endereço, é possível buscar pelos logs deste:

```bash
cat /var/log/apache2/access.log | grep "<endereço de IP suspeito>"
```

- Para descobrir quando foi o primeiro e último acesso deste:

```bash
cat /var/log/apache2/access.log | grep "<endereço de IP suspeito>" | head -n1
```

```bash
cat /var/log/apache2/access.log | grep "<endereço de IP suspeito>" | tail -n1
```

- Um fator que caracteriza um ataque é o número de requisições por período de tempo. Um número grande de requisições por segundo caracteriza ataques com ferramentas automatizadas.

- Além disso também é possível filtrar por ferramentas utilizadas como no exemplo abaixo:

```bash
cat /var/log/apache2/access.log | grep "<endereço de IP suspeito>" | grep "Nmap"| head -1n
```