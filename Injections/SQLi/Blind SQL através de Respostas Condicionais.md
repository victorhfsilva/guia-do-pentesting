## Explorando Blind SQL Injection através de Respostas Condicionais

Blind SQL Injection (SQLi Cega) pode ser explorado em situações onde a aplicação não retorna diretamente os resultados da consulta SQL injetada, mas apresenta um comportamento diferente com base nas condições que a consulta encontra. Esta técnica permite que um atacante extraia informações sensíveis ao manipular as respostas da aplicação a partir de condições SQL injetadas.

### Exemplo de Exploração

Considere uma aplicação que utiliza cookies de rastreamento para coletar dados analíticos sobre o uso dos usuários. Os pedidos enviados para a aplicação incluem um cabeçalho de cookie, como o exemplo abaixo:

```http
Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4
```

Quando um pedido contendo o cookie `TrackingId` é processado, a aplicação utiliza a seguinte consulta SQL para verificar se o usuário é conhecido:

```sql
SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'
```

Esta consulta é vulnerável a SQL Injection, mas os resultados da consulta não são retornados ao usuário. No entanto, o comportamento da aplicação muda dependendo se a consulta retorna ou não dados. Por exemplo, se o `TrackingId` for reconhecido, a aplicação exibe uma mensagem de "Bem-vindo de volta" na resposta.

Esse comportamento permite que a vulnerabilidade de Blind SQL Injection seja explorada ao condicionar a resposta da aplicação com base em uma condição injetada.

### Como a Exploração Funciona

Para entender como essa exploração funciona, considere dois pedidos enviados à aplicação com os seguintes valores para o cookie `TrackingId`:

1. `…xyz' AND '1'='1`
2. `…xyz' AND '1'='2`

- **Primeiro valor:** A condição injetada `AND '1'='1` é verdadeira, então a consulta retorna resultados, e a mensagem de "Bem-vindo de volta" é exibida.
- **Segundo valor:** A condição injetada `AND '1'='2` é falsa, então a consulta não retorna resultados, e a mensagem de "Bem-vindo de volta" não é exibida.

Esse padrão de respostas permite determinar a verdade de qualquer condição injetada, e possibilita a extração de dados, um pedaço por vez.

### Exemplo de Extração de Dados

Vamos supor que existe uma tabela chamada `Users` com as colunas `Username` e `Password`, e um usuário chamado `Administrator`. É possível determinar a senha desse usuário enviando uma série de entradas para testar cada caractere da senha, um por vez.

**Passo 1:** Comece com a seguinte entrada:

```sql
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 'm
```

Se a mensagem "Bem-vindo de volta" for exibida, isso indica que a condição injetada é verdadeira e, portanto, o primeiro caractere da senha é maior que `m`.

**Passo 2:** Em seguida, envie a seguinte entrada:

```sql
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 't
```

Se a mensagem "Bem-vindo de volta" não for exibida, isso indica que a condição injetada é falsa, e o primeiro caractere da senha não é maior que `t`.

**Passo 3:** Continue ajustando a condição até encontrar o caractere correto. Por exemplo:

```sql
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) = 's
```

Se a mensagem "Bem-vindo de volta" for exibida, isso confirma que o primeiro caractere da senha é `s`.

### Continuação do Processo

Esse processo pode ser repetido para cada caractere da senha, até que a senha completa do usuário `Administrator` seja descoberta. A função `SUBSTRING` utilizada neste exemplo pode variar conforme o tipo de banco de dados, podendo ser chamada de `SUBSTR` em alguns casos.
