#  Ncat

## Introdução

Ncat é uma ferramenta de rede moderna que faz parte do pacote **Nmap**, sendo projetada para ser uma versão aprimorada do Netcat (`nc`). Ele oferece funcionalidades adicionais como criptografia SSL, autenticação e suporte a IPv6, além de ser altamente versátil para depuração, transferência de arquivos, redirecionamento de portas, e execução de comandos remotos. Este guia irá abordar os principais usos do Ncat, desde funções básicas até opções avançadas.

## Instalação

### Instalação no Linux

Ncat geralmente já está incluído no pacote **Nmap**. Para instalar o Nmap e obter o Ncat no Linux:

- **Debian/Ubuntu**:
  ```bash
  sudo apt-get update
  sudo apt-get install nmap
  ```

- **CentOS/RHEL**:
  ```bash
  sudo yum install nmap
  ```

### Instalação no macOS
No macOS, você pode instalar o Ncat usando o Homebrew:

```bash
brew install nmap
```

### Verificando a Instalação
Para verificar se o Ncat está instalado corretamente, digite o comando:

```bash
ncat --help
```

## Comandos Básicos do Ncat

### Criando uma Conexão TCP

#### Cliente TCP
Para iniciar uma conexão TCP com um servidor em uma porta específica, use o seguinte comando:

```bash
ncat <endereço IP ou hostname> <porta>
```

#### Exemplo
Conectando-se a um servidor na porta 80:

```bash
ncat example.com 80
```

### Criando um Listener (Servidor TCP)

Ncat pode ser usado para criar um servidor que escuta conexões em uma porta específica. Isso é útil para depuração, testes de rede ou simplesmente receber conexões.

#### Exemplo
Criando um listener na porta 1234:

```bash
ncat -l 1234
```

Este comando inicia um servidor na porta 1234 que aguarda conexões.

### ransferência de Arquivos

Ncat facilita a transferência de arquivos entre dois hosts.

#### Enviando um Arquivo
No servidor que está enviando o arquivo:
```bash
ncat <endereço IP do destinatário> <porta> < arquivo
```

##### Exemplo
Enviando o arquivo `example.txt` para um cliente que está ouvindo na porta 1234:

```bash
ncat 192.168.1.10 1234 < example.txt
```

#### Recebendo um Arquivo
No cliente que está recebendo o arquivo:
```bash
ncat -l 1234 > arquivo
```

##### Exemplo
Recebendo o arquivo `example.txt` na porta 1234:

```bash
ncat -l 1234 > example.txt
```

### Verificando se uma Porta Está Aberta

Ncat pode ser usado para verificar se uma porta está aberta em um servidor específico, semelhante a uma varredura de portas.

##### Exemplo
Verificando se a porta 80 está aberta no servidor `example.com`:

```bash
ncat -zv example.com 80
```

- `-z`: Não envia dados, apenas verifica se a porta está aberta.
- `-v`: Habilita a saída detalhada.

### Chat Simples com Ncat

Ncat pode ser utilizado para criar um chat simples entre duas máquinas.

##### Exemplo

- **No servidor** (listener):
  ```bash
  ncat -l 1234
  ```

- **No cliente** (conectando ao servidor):
  ```bash
  ncat <endereço IP do servidor> 1234
  ```

Agora, qualquer texto digitado por uma das partes será enviado e exibido na outra máquina.

### Executando Comandos Remotamente

Ncat permite criar uma simples "shell reversa" que executa comandos remotamente em uma máquina alvo.

#### Shell Remota (Servidor)
```bash
ncat -l 1234 --exec "/bin/bash"
```

#### Conectando à Shell Remota (Cliente)
```bash
ncat <endereço IP do servidor> 1234
```

### Criptografia com SSL

Uma das grandes vantagens do Ncat sobre o Netcat tradicional é o suporte a criptografia SSL, o que torna as conexões mais seguras.

#### Exemplo
Criando um listener criptografado SSL:

```bash
ncat --ssl -l 1234
```

Conectando a esse listener com SSL:

```bash
ncat --ssl <endereço IP do servidor> 1234
```

### Redirecionamento de Portas

Ncat pode ser usado para redirecionar tráfego de uma porta para outra, útil para criar proxies ou realizar tunelamento.

#### Exemplo
Redirecionando o tráfego da porta 1234 para a porta 80:

```bash
ncat -l 1234 --sh-exec "ncat example.com 80"
```

## Funções Avançadas do Ncat

### Enviando Pacotes UDP

Ncat também suporta o envio de pacotes via UDP. Para especificar o uso do protocolo UDP, adicione a opção `-u`.

#### Exemplo
Enviando pacotes UDP para o servidor `example.com` na porta 1234:

```bash
ncat -u example.com 1234
```

Criando um listener UDP:

```bash
ncat -u -l 1234
```

### Autenticação com Ncat

Ncat oferece suporte a autenticação para validar conexões remotas, garantindo que apenas usuários autorizados possam se conectar.

##### Exemplo
Criando um listener com autenticação:

```bash
ncat --listen --allow 192.168.1.0/24 --ssl --ssl-cert cert.pem --ssl-key key.pem 1234
```

Neste exemplo, apenas conexões da rede `192.168.1.0/24` são permitidas, e a comunicação é criptografada com SSL.

Para gerar certificados e chaves de conexão SSL basta utilizar:

```bash
openssl re -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 10
```

### Usando Ncat com IPv6

Ncat oferece suporte completo ao protocolo IPv6. Para usar o IPv6 em vez do IPv4, basta adicionar a opção `-6`.

##### Exemplo
Conectando-se a um servidor via IPv6:

```bash
ncat -6 <endereço IPv6> <porta>
```

### Proxy com Ncat

Ncat pode ser utilizado como um proxy simples, redirecionando tráfego de uma porta para outra.

#### Exemplo
Criando um proxy na porta 1234 que redireciona para `example.com` na porta 80:

```bash
ncat -l 1234 --proxy-type http --sh-exec "ncat example.com 80"
```

### Scripts de Execução Automática

Ncat também pode ser usado com scripts que executam automaticamente após a conexão. O script é especificado com a opção `--sh-exec`.

##### Exemplo
Executando um script após a conexão:

```bash
ncat -l 1234 --sh-exec "echo 'Conexão estabelecida'; /bin/bash"
```

## Comparação entre Ncat e Netcat

Embora Ncat tenha sido inspirado no Netcat, ele traz uma série de melhorias e funcionalidades adicionais:

- **Criptografia SSL**: Ncat suporta SSL para conexões seguras.
- **Autenticação**: Ncat oferece suporte a autenticação de conexões.
- **IPv6**: Ncat possui suporte completo ao protocolo IPv6.
- **Proxy**: Ncat pode atuar como um proxy HTTP ou SOCKS.

## Segurança com Ncat

Devido à sua versatilidade, Ncat pode ser usado tanto para fins legítimos quanto para atividades maliciosas. Por exemplo, ele pode ser utilizado para criar backdoors em sistemas comprometidos. Portanto, ao utilizar Ncat, certifique-se de que ele está sendo usado em um ambiente controlado e com permissão explícita.
